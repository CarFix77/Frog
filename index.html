<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyRhythm</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        :root {
            --primary: #FF2E2E;
            --primary-dark: #CC0000;
            --primary-light: #FF6B6B;
            --accent: #00C853;
            --accent-dark: #00A844;
            --purple: #9C27B0;
            --blue: #2196F3;
            --cyan: #00BCD4;
            --orange: #FF9800;
            --pink: #E91E63;
            --indigo: #3F51B5;

            --bg-dark: #000000;
            --bg-card: #1A1A1A;
            --bg-surface: #242424;
            --bg-hover: #2C2C2C;

            --border: #333333;
            --border-light: #404040;

            --text-primary: #FFFFFF;
            --text-secondary: #B3B3B3;
            --text-tertiary: #666666;

            --gradient-primary: linear-gradient(135deg, #FF2E2E 0%, #FF6B00 100%);
            --gradient-accent: linear-gradient(135deg, #00C853 0%, #00D4AA 100%);
            --gradient-purple: linear-gradient(135deg, #9C27B0 0%, #673AB7 100%);
            --gradient-blue: linear-gradient(135deg, #2196F3 0%, #03A9F4 100%);
            --gradient-cyan: linear-gradient(135deg, #00BCD4 0%, #0097A7 100%);
            --gradient-orange: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
            --gradient-pink: linear-gradient(135deg, #E91E63 0%, #C2185B 100%);
            --gradient-indigo: linear-gradient(135deg, #3F51B5 0%, #303F9F 100%);

            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
            --shadow-xl: 0 16px 64px rgba(0, 0, 0, 0.6);

            --glow-primary: 0 0 20px rgba(255, 46, 46, 0.3);
            --glow-accent: 0 0 20px rgba(0, 200, 83, 0.3);
            --glow-cyan: 0 0 20px rgba(0, 188, 212, 0.3);
            --glow-orange: 0 0 20px rgba(255, 152, 0, 0.3);
        }

        body {
            background: var(--bg-dark);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* Фон с частицами */
        .particles-bg {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-dark);
            z-index: -2;
            overflow: hidden;
        }

        .gradient-layer {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            opacity: 0.05;
            background: 
                radial-gradient(circle at 20% 80%, var(--primary) 0%, transparent 40%),
                radial-gradient(circle at 80% 20%, var(--purple) 0%, transparent 40%);
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 1000;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .settings-btn {
            width: 40px;
            height: 40px;
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .settings-btn:hover {
            background: var(--bg-hover);
            border-color: var(--border-light);
            transform: rotate(30deg);
        }

        .settings-btn::before {
            content: '';
            width: 20px;
            height: 20px;
            background: var(--text-primary);
            mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z'/%3E%3C/svg%3E") center/contain no-repeat;
        }

        .search-bar {
            flex: 1;
            max-width: 500px;
            position: relative;
            margin: 0 20px;
        }

        .search-input {
            width: 100%;
            padding: 12px 20px 12px 48px;
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 25px;
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            background: var(--bg-card);
            box-shadow: 0 0 0 3px rgba(255, 46, 46, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            background: var(--text-secondary);
            mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z'/%3E%3C/svg%3E") center/contain no-repeat;
            pointer-events: none;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid var(--primary);
            transition: all 0.2s ease;
        }

        .user-avatar:hover {
            transform: scale(1.05);
            border-color: var(--primary-light);
        }

        .user-avatar-placeholder {
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
        }

        /* Main Content */
        .main-content {
            padding-top: 60px;
            padding-bottom: 140px;
            height: 100vh;
            overflow-y: auto;
            position: relative;
            -webkit-overflow-scrolling: touch;
        }

        /* КОНТЕЙНЕР С ГРАНИЦАМИ */
        .content-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            padding: 0 20px;
        }

        /* Главная секция - Мой ритм */
        .sound-hero-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 40vh;
            padding: 20px 20px 10px;
            position: relative;
            text-align: center;
            margin-bottom: 10px;
        }

        .sound-hero-title {
            font-size: 36px;
            font-weight: 900;
            background: linear-gradient(45deg, 
                var(--primary) 0%,
                var(--purple) 50%,
                var(--blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 1px;
            margin-bottom: 10px;
            position: relative;
        }

        .sound-hero-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }

        .sound-hero-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 20px;
            max-width: 400px;
            line-height: 1.4;
        }

        /* АНИМАЦИЯ ПОЛОС */
        .sound-visualizer {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 6px;
            height: 60px;
            margin-top: 10px;
            position: relative;
        }

        .visualizer-bar {
            width: 8px;
            background: var(--gradient-primary);
            border-radius: 4px 4px 0 0;
            animation: visualizerMove 1.5s ease-in-out infinite;
        }

        .visualizer-bar:nth-child(2n) {
            background: var(--gradient-purple);
            animation-delay: 0.2s;
        }

        .visualizer-bar:nth-child(3n) {
            background: var(--gradient-blue);
            animation-delay: 0.4s;
        }

        .visualizer-bar:nth-child(5n) {
            background: var(--gradient-accent);
            animation-delay: 0.6s;
        }

        @keyframes visualizerMove {
            0%, 100% {
                height: 12px;
            }
            50% {
                height: 50px;
            }
        }

        .sound-hero-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .hero-action-btn {
            position: relative;
            padding: 12px 30px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 160px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .hero-action-btn.primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .hero-action-btn.secondary {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--primary);
        }

        .hero-action-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        /* СТАЙЛЫ ДЛЯ НОВОГО СЛАЙДЕРА */
        .slider-wrapper {
            position: relative;
            width: 100%;
            height: 110px;
            border-radius: 20px;
            overflow: hidden;
            margin: 15px 0 20px;
            background: #000;
            border: 1px solid var(--border);
            box-shadow: var(--shadow-lg);
        }

        .slides-container {
            display: flex;
            overflow-x: scroll;
            overflow-y: hidden;
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
            height: 100%;
            scrollbar-width: none;
        }

        .slides-container::-webkit-scrollbar {
            display: none;
        }

        .slide {
            flex: 0 0 100%;
            width: 100%;
            height: 110px;
            scroll-snap-align: center;
            position: relative;
            display: flex;
            padding: 15px 20px;
            box-sizing: border-box;
            overflow: hidden;
        }

        .close-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 24px;
            height: 24px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 14px;
            z-index: 100;
            cursor: pointer;
            border: none;
            backdrop-filter: blur(10px);
        }

        .slider-content {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 100%;
            z-index: 10;
            max-width: 55%;
        }

        .slider-title {
            color: #fff;
            font-size: 16px;
            font-weight: 800;
            line-height: 1.2;
            margin: 0;
        }

        .slider-link {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-size: 13px;
            font-weight: 600;
        }

        /* Слайд 1: Музыка + WiFi */
        .slide-music {
            background: linear-gradient(135deg, #4a00b4 0%, #6200ee 50%, #7e3ff2 100%);
        }

        .stage-music {
            position: absolute;
            right: 20px;
            height: 100%;
            top: 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .wifi {
            display: flex;
            align-items: flex-end;
            gap: 2px;
        }

        .bar {
            width: 5px;
            background: #fff;
            border-radius: 2px;
        }

        .b4 { height: 34px; animation: wifiSeq 4s infinite 0.0s; }
        .b3 { height: 26px; animation: wifiSeq 4s infinite 0.2s; }
        .b2 { height: 18px; animation: wifiSeq 4s infinite 0.4s; }
        .b1 { height: 10px; animation: wifiSeq 4s infinite 0.6s; }

        @keyframes wifiSeq {
            0%, 15% { opacity: 1; }
            45%, 55% { opacity: 0.15; }
            85%, 100% { opacity: 1; }
        }

        .cross-sticker {
            position: absolute;
            width: 42px;
            height: 42px;
            opacity: 0;
            transform: scale(0);
            animation: crossP 4s infinite;
        }

        @keyframes crossP {
            0%, 35% { opacity: 0; transform: scale(0.4); }
            45%, 85% { opacity: 1; transform: scale(1.1); }
            95%, 100% { opacity: 0; transform: scale(0.4); }
        }

        .human-box {
            position: relative;
            width: 60px;
            height: 60px;
            animation: vibe 0.5s infinite alternate ease-in-out;
        }

        @keyframes vibe {
            from { transform: rotate(-3deg); }
            to { transform: rotate(3deg); }
        }

        .note {
            position: absolute;
            font-size: 16px;
            opacity: 0;
            animation: noteFloat 2s infinite linear;
        }

        @keyframes noteFloat {
            0% { transform: translate(0, 0) scale(0.5); opacity: 0; }
            20% { opacity: 1; }
            100% { transform: translate(15px, -35px) rotate(20deg); opacity: 0; }
        }

        /* Слайд 2: Кристалл */
        .slide-gem {
            background: linear-gradient(135deg, #082d27 0%, #041916 100%);
        }

        .gem-stage {
            position: absolute;
            right: 40px;
            width: 100px;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .diamond {
            font-size: 44px;
            z-index: 10;
            filter: drop-shadow(0 0 15px #00ffa3);
            animation: floatG 3s infinite ease-in-out;
        }

        .orbit {
            position: absolute;
            border: 2px solid #00ffa3;
            border-radius: 50%;
            opacity: 0.4;
            animation: rotO 3s linear infinite;
            transform: rotateX(75deg);
        }

        .sparkle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: #fff;
            border-radius: 50%;
            animation: particleFly 2s infinite linear;
            opacity: 0;
        }

        @keyframes floatG {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        @keyframes rotO {
            0% { transform: rotateX(75deg) rotateZ(0deg); }
            100% { transform: rotateX(75deg) rotateZ(360deg); }
        }

        @keyframes particleFly {
            0% { transform: translate(0,0); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translate(25px, -25px); opacity: 0; }
        }

        /* Слайд 3: Криптовалюта */
        .slide-crypto {
            background: linear-gradient(135deg, #4a00b4 0%, #6200ee 50%, #7e3ff2 100%);
        }

        .crypto-stage {
            position: absolute;
            right: 10px;
            width: 180px;
            height: 100%;
        }

        .coin-3d {
            position: absolute;
            width: 34px;
            height: 34px;
            border-radius: 50%;
            border: 2.2px solid #000;
            box-shadow: 0 4.5px 0 #000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: coinFloat 3.5s infinite ease-in-out;
            overflow: hidden;
        }

        .c-btc { background: #f7931a; top: 10px; right: 20px; color: #fff; font-weight: 900; font-size: 18px; }
        .c-ton { background: #0098EA; top: 58px; right: 55px; padding: 0; }
        .c-usdt { background: #26a17b; top: 8px; right: 95px; color: #fff; font-weight: 900; font-size: 16px; }
        .c-eth { background: #627eea; top: 50px; right: 120px; color: #fff; font-weight: 900; font-size: 18px; }

        @keyframes coinFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-7px); }
        }

        .confetti {
            position: absolute;
            width: 6px;
            height: 3px;
            border-radius: 2px;
            opacity: 0.4;
            animation: conf 3s infinite linear;
        }

        @keyframes conf {
            0% { transform: translate(0,0); opacity: 0; }
            50% { opacity: 0.4; }
            100% { transform: translate(-30px, -30px); opacity: 0; }
        }

        /* Пагинация слайдера */
        .slider-dots {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 6px;
            z-index: 50;
        }

        .dot {
            width: 6px;
            height: 6px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transition: 0.3s;
        }

        .dot.active {
            width: 18px;
            background: #fff;
            border-radius: 10px;
        }

        /* Подборки музыки */
        .moods-section {
            margin: 20px 0;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-primary);
            position: relative;
            display: inline-block;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 0;
            width: 50px;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }

        .moods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .mood-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .mood-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-primary);
        }

        .mood-card:hover {
            transform: translateY(-4px);
            background: var(--bg-hover);
            border-color: var(--border-light);
            box-shadow: var(--shadow-lg);
        }

        .mood-title {
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mood-icon {
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .mood-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* Табы контента */
        .content-tabs {
            display: flex;
            gap: 8px;
            margin: 20px 0;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .tab {
            background: none;
            border: none;
            padding: 10px 20px;
            font-size: 15px;
            color: var(--text-secondary);
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
            border-radius: 8px;
            font-weight: 500;
        }

        .tab:hover {
            background: var(--bg-surface);
            color: var(--text-primary);
        }

        .tab.active {
            color: var(--text-primary);
            font-weight: 600;
            background: var(--bg-surface);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }

        /* Контейнер для контента табов */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* СТРАНИЦА НАСТРОЕК */
        .settings-page {
            display: none;
            animation: fadeIn 0.3s ease;
            padding: 20px 0 100px;
        }

        .settings-page.active {
            display: block;
        }

        .settings-section {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
            padding: 20px;
            margin-bottom: 20px;
        }

        .settings-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .settings-title::before {
            content: '';
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .settings-title.language::before {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z'/%3E%3C/svg%3E") center/14px no-repeat var(--primary);
        }

        .settings-title.support::before {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z'/%3E%3C/svg%3E") center/14px no-repeat var(--primary);
        }

        .settings-title.subscription::before {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5l-3-4zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm13.5-9l1.96 2.5H17V9.5h2.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z'/%3E%3C/svg%3E") center/14px no-repeat var(--primary);
        }

        /* Языки */
        .languages-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 12px;
        }

        .language-option {
            background: var(--bg-surface);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .language-option:hover {
            background: var(--bg-hover);
            border-color: var(--primary-light);
            transform: translateY(-2px);
        }

        .language-option.active {
            border-color: var(--primary);
            background: rgba(255, 46, 46, 0.1);
        }

        .language-flag {
            width: 35px;
            height: 25px;
            border-radius: 3px;
            object-fit: cover;
            border: 1px solid var(--border);
        }

        .language-info {
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }

        .language-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .language-natives {
            font-size: 11px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Техподдержка */
        .support-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .support-option {
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .support-option:hover {
            background: var(--bg-hover);
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .support-icon {
            width: 45px;
            height: 45px;
            border-radius: 22px;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .support-icon::before {
            content: '';
            width: 20px;
            height: 20px;
            background: white;
            mask-position: center;
            mask-repeat: no-repeat;
            mask-size: contain;
        }

        .support-option:nth-child(1) .support-icon::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 12h-2v-2h2v2zm0-4h-2V6h2v4z'/%3E%3C/svg%3E");
        }

        .support-option:nth-child(2) .support-icon::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z'/%3E%3C/svg%3E");
        }

        .support-option:nth-child(3) .support-icon::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z'/%3E%3C/svg%3E");
        }

        .support-info {
            flex: 1;
            min-width: 0;
        }

        .support-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .support-description {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* КРАСИВЫЙ ЗАГОЛОВОК ПОДПИСКИ */
        .subscription-header {
            text-align: center;
            margin-bottom: 25px;
            padding: 20px;
            background: linear-gradient(135deg, 
                rgba(255, 46, 46, 0.1),
                rgba(156, 39, 176, 0.1));
            border-radius: 16px;
            border: 2px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .subscription-title {
            font-size: 32px;
            font-weight: 900;
            background: linear-gradient(45deg, 
                var(--primary) 20%,
                var(--purple) 50%,
                var(--blue) 80%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
            word-wrap: break-word;
            max-width: 100%;
        }

        .subscription-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            max-width: 400px;
            margin: 10px auto 0;
            line-height: 1.4;
        }

        /* ОБНОВЛЕННЫЕ ПОДПИСКИ - УБРАЛ ВСЕ ОРАНЖЕВЫЕ ПОЛОСКИ */
        .subscription-plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .plan-card {
            background: linear-gradient(145deg, var(--bg-card), var(--bg-dark));
            border-radius: 16px;
            border: 2px solid var(--border);
            padding: 25px 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .plan-card:hover {
            transform: translateY(-8px);
            border-color: var(--primary);
            box-shadow: 
                0 15px 30px rgba(0, 0, 0, 0.4),
                0 0 80px rgba(255, 46, 46, 0.1);
        }

        .plan-card.popular {
            border-color: var(--primary);
            background: linear-gradient(145deg, 
                rgba(255, 46, 46, 0.15),
                rgba(26, 26, 26, 0.95)
            );
            position: relative;
        }

        /* УБРАЛ ВСЕ ОРАНЖЕВЫЕ ПОЛОСКИ И НАДПИСИ ПОПУЛЯРНЫЙ ВЫБОР */
        .plan-card.popular::after {
            display: none; /* Убрал надпись "Популярный выбор" */
        }

        /* УБРАЛ ВСЕ ОРАНЖЕВЫЕ ПОЛОСКИ */
        .plan-card.popular::before {
            display: none;
        }

        /* УДАЛИЛ ВСЕ ДОПОЛНИТЕЛЬНЫЕ ОРАНЖЕВЫЕ ПОЛОСКИ */

        .plan-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
            position: relative;
            z-index: 5;
        }

        .plan-period {
            font-size: 13px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .plan-price-container {
            display: flex;
            align-items: baseline;
            justify-content: center;
            gap: 6px;
            margin-bottom: 5px;
            position: relative;
            z-index: 5;
        }

        .plan-price {
            font-size: 48px;
            font-weight: 900;
            line-height: 1;
            background: linear-gradient(45deg, var(--text-primary), var(--text-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            display: inline-block;
        }

        .plan-card.popular .plan-price {
            background: linear-gradient(45deg, var(--primary), var(--purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .plan-currency {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-secondary);
            margin-left: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
            position: relative;
            z-index: 5;
        }

        /* ИКОНКА TON */
        .ton-icon {
            width: 20px;
            height: 20px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .ton-icon svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 0 4px rgba(0, 152, 234, 0.5));
        }

        .plan-savings {
            background: linear-gradient(45deg, var(--primary), var(--purple));
            color: white;
            padding: 6px 14px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 700;
            display: inline-block;
            margin-top: 8px;
            box-shadow: var(--shadow-sm);
            letter-spacing: 0.5px;
            position: relative;
            z-index: 5;
        }

        /* ИСПРАВЛЕННЫЕ КРУЖКИ С ГАЛОЧКАМИ */
        .plan-features {
            flex: 1;
            margin-bottom: 25px;
            position: relative;
            z-index: 5;
        }

        .plan-feature {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
            font-size: 13px;
            color: var(--text-secondary);
            position: relative;
            padding-left: 0;
        }

        .plan-feature::before {
            content: '';
            width: 18px;
            height: 18px;
            background: linear-gradient(45deg, var(--accent), var(--cyan));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            position: relative;
            box-shadow: 0 3px 6px rgba(0, 200, 83, 0.3);
            margin-top: 1px;
        }

        .plan-feature::after {
            content: '✓';
            position: absolute;
            left: 4px;
            color: white;
            font-size: 10px;
            font-weight: bold;
            top: 5px;
        }

        .plan-card.popular .plan-feature::before {
            background: linear-gradient(45deg, var(--primary), var(--purple));
            box-shadow: 0 3px 6px rgba(255, 46, 46, 0.3);
        }

        .plan-button {
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 800;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            width: 100%;
            position: relative;
            overflow: hidden;
            z-index: 5;
        }

        .plan-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent);
            transition: left 0.5s ease;
        }

        .plan-button:hover::before {
            left: 100%;
        }

        .plan-card .plan-button {
            background: linear-gradient(135deg, var(--primary), var(--purple));
            color: white;
            box-shadow: 
                0 6px 20px rgba(255, 46, 46, 0.3);
        }

        .plan-card.popular .plan-button {
            background: linear-gradient(135deg, var(--primary), var(--purple));
            color: white;
            box-shadow: 
                0 8px 25px rgba(255, 46, 46, 0.4);
        }

        .plan-button:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 12px 30px rgba(255, 46, 46, 0.5);
        }

        /* Контейнер для промокода */
        .promocode-container {
            margin-top: 30px;
            padding: 20px;
            background: var(--bg-card);
            border-radius: 14px;
            border: 1px solid var(--border);
        }

        .promocode-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .promocode-title::before {
            content: '';
            width: 20px;
            height: 20px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23FF9800'%3E%3Cpath d='M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z'/%3E%3C/svg%3E") center/contain no-repeat;
        }

        .promocode-input-container {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }

        .promocode-input {
            flex: 1;
            padding: 12px 16px;
            background: var(--bg-surface);
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.3s ease;
            min-width: 0;
        }

        .promocode-input:focus {
            outline: none;
            border-color: var(--primary);
            background: var(--bg-card);
            box-shadow: 0 0 0 3px rgba(255, 46, 46, 0.1);
        }

        .promocode-btn {
            padding: 12px 20px;
            background: var(--gradient-accent);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .promocode-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .promocode-description {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* СТРАНИЦА КОЛЛЕКЦИИ */
        .collection-page {
            display: none;
            animation: fadeIn 0.3s ease;
            padding: 20px 0 100px;
        }

        .collection-page.active {
            display: block;
        }

        .empty-collection {
            text-align: center;
            padding: 50px 20px;
            background: var(--bg-card);
            border-radius: 14px;
            border: 2px dashed var(--border);
            margin-bottom: 25px;
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .empty-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .empty-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            max-width: 350px;
            margin: 0 auto 15px;
            line-height: 1.4;
        }

        .collection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 25px;
        }

        .collection-track-item {
            background: var(--bg-card);
            border-radius: 10px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            padding: 12px;
            gap: 12px;
            cursor: pointer;
        }

        .collection-track-item:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
            box-shadow: var(--shadow-lg);
            background: var(--bg-hover);
        }

        .collection-track-image {
            width: 50px;
            height: 50px;
            border-radius: 6px;
            object-fit: cover;
            flex-shrink: 0;
            background: linear-gradient(135deg, var(--bg-surface), var(--border));
        }

        .collection-track-info {
            flex: 1;
            min-width: 0;
        }

        .collection-track-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .collection-track-artist {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .collection-track-meta {
            display: flex;
            gap: 12px;
            font-size: 11px;
            color: var(--text-tertiary);
        }

        /* РАЗДЕЛ "ДЛЯ ВАС" - УЛУЧШЕННАЯ ПРОКРУТКА */
        .for-you-section {
            margin-bottom: 30px;
            position: relative;
        }

        .for-you-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .for-you-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .for-you-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .scroll-buttons {
            display: flex;
            gap: 8px;
        }

        .scroll-btn {
            width: 35px;
            height: 35px;
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .scroll-btn:hover {
            background: var(--bg-hover);
            border-color: var(--border-light);
        }

        .scroll-btn::before {
            content: '';
            width: 16px;
            height: 16px;
            background: var(--text-primary);
            mask-position: center;
            mask-repeat: no-repeat;
            mask-size: contain;
        }

        .scroll-btn.prev::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z'/%3E%3C/svg%3E");
        }

        .scroll-btn.next::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z'/%3E%3C/svg%3E");
        }

        /* УЛУЧШЕННЫЙ КОНТЕЙНЕР ДЛЯ КОЛОНОК С ПЛАВНОЙ ПРОКРУТКОЙ */
        .tracks-columns-container {
            display: flex;
            gap: 20px;
            width: 100%;
            overflow-x: auto;
            padding: 10px 0 30px;
            scroll-behavior: smooth;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
            scroll-snap-type: x mandatory;
            cursor: grab;
            user-select: none; /* Запрещаем выделение текста при перетаскивании */
        }

        .tracks-columns-container::-webkit-scrollbar {
            display: none;
        }

        .tracks-column {
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-width: 350px;
            flex-shrink: 0;
            scroll-snap-align: start;
        }

        /* ИНДИКАТОРЫ ПРОКРУТКИ - ТОЧКИ */
        .scroll-indicators {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 15px;
            height: 20px;
        }

        .scroll-indicator-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--text-tertiary);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .scroll-indicator-dot.active {
            width: 24px;
            height: 6px;
            border-radius: 3px;
            background: var(--gradient-primary);
        }

        .scroll-indicator-dot:hover {
            background: var(--primary-light);
            transform: scale(1.2);
        }

        .track-card-for-you {
            background: var(--bg-card);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--border);
            position: relative;
            height: 90px;
            display: flex;
            align-items: center;
            padding: 15px;
            gap: 15px;
        }

        .track-card-for-you:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
            box-shadow: var(--shadow-lg), var(--glow-primary);
        }

        .track-image-for-you {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            object-fit: cover;
            flex-shrink: 0;
            background: linear-gradient(135deg, var(--bg-surface), var(--border));
        }

        .track-info-for-you {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            height: 100%;
        }

        .track-title-for-you {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-artist-for-you {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-meta-for-you {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 11px;
            color: var(--text-tertiary);
        }

        /* Коллекции (для Тренды и Новинки) - остаются альбомами */
        .collections-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 15px;
            margin: 15px 0 40px;
        }

        .collection-card {
            background: var(--bg-card);
            border-radius: 14px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--border);
            position: relative;
        }

        .collection-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: var(--shadow-xl), var(--glow-primary);
        }

        .collection-image {
            width: 100%;
            height: 160px;
            object-fit: cover;
            transition: transform 0.6s ease;
            background: linear-gradient(135deg, var(--bg-surface), var(--border));
        }

        .collection-card:hover .collection-image {
            transform: scale(1.05);
        }

        .collection-info {
            padding: 12px;
        }

        .collection-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .collection-artist {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .collection-stats {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 10px;
            color: var(--text-tertiary);
        }

        .collection-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 700;
            margin-top: 5px;
        }

        .collection-badge.trending {
            background: var(--gradient-purple);
            color: white;
        }

        .collection-badge.new {
            background: var(--gradient-blue);
            color: white;
        }

        /* Страница альбома (для Тренды и Новинки) */
        .album-page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .album-page.active {
            display: block;
        }

        .album-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 15px;
            margin-bottom: 25px;
            padding: 25px;
            background: var(--bg-card);
            border-radius: 14px;
            border: 1px solid var(--border);
            position: relative;
        }

        .album-cover-large {
            width: 200px;
            height: 200px;
            border-radius: 10px;
            object-fit: cover;
            box-shadow: var(--shadow-xl);
            flex-shrink: 0;
            background: linear-gradient(135deg, var(--bg-surface), var(--border));
        }

        .album-info {
            flex: 1;
            min-width: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .album-type {
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin-bottom: 6px;
            opacity: 0.8;
        }

        .album-name-large {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 6px;
            color: var(--text-primary);
            line-height: 1.2;
            word-wrap: break-word;
            overflow-wrap: break-word;
            text-align: center;
            max-width: 100%;
        }

        .album-artist-large {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }

        .album-meta-large {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 13px;
            color: var(--text-tertiary);
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .album-meta-large span {
            white-space: nowrap;
        }

        .album-actions {
            display: flex;
            justify-content: center;
            width: 100%;
            margin-top: 8px;
        }

        .play-album-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 10px 30px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            min-width: 180px;
            justify-content: center;
            white-space: nowrap;
        }

        .play-album-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg), var(--glow-primary);
        }

        /* Список треков в альбоме */
        .tracks-list-section {
            margin-top: 30px;
        }

        .tracks-list-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .tracks-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .track-item-album {
            display: flex;
            align-items: center;
            padding: 10px 14px;
            background: var(--bg-card);
            border-radius: 10px;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .track-item-album:hover {
            background: var(--bg-hover);
            border-color: var(--primary-light);
            transform: translateX(5px);
        }

        .track-number-album {
            width: 35px;
            font-size: 13px;
            color: var(--text-tertiary);
            font-weight: 600;
            flex-shrink: 0;
            text-align: center;
        }

        .track-image-album {
            width: 45px;
            height: 45px;
            border-radius: 6px;
            object-fit: cover;
            margin-right: 12px;
            flex-shrink: 0;
            background: linear-gradient(135deg, var(--bg-surface), var(--border));
        }

        .track-info-album {
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }

        .track-title-album {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-artist-album {
            font-size: 12px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-duration-album {
            font-size: 13px;
            color: var(--text-tertiary);
            flex-shrink: 0;
            margin-left: 12px;
            white-space: nowrap;
        }

        .back-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 15px;
            padding: 8px 0;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .back-btn:hover {
            color: var(--text-primary);
        }

        /* Player */
        .player {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 40px);
            max-width: 1200px;
            height: 60px;
            background: var(--bg-card);
            border-radius: 12px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            gap: 12px;
            z-index: 999;
            border: 1px solid var(--border);
            box-shadow: var(--shadow-xl);
        }

        .player-cover {
            width: 35px;
            height: 35px;
            border-radius: 6px;
            object-fit: cover;
            box-shadow: var(--shadow-md);
            flex-shrink: 0;
            background: linear-gradient(135deg, var(--bg-surface), var(--border));
        }

        .player-info {
            flex: 1;
            min-width: 0;
        }

        .player-title {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player-artist {
            font-size: 11px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
        }

        .control-btn {
            width: 32px;
            height: 32px;
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            flex-shrink: 0;
        }

        .control-btn:hover {
            background: var(--bg-hover);
            border-color: var(--border-light);
            transform: scale(1.05);
        }

        .control-btn.liked {
            background: var(--primary);
            border-color: var(--primary);
        }

        .control-btn.heart::before,
        .control-btn.next::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 16px;
            height: 16px;
            background: var(--text-primary);
            mask-position: center;
            mask-repeat: no-repeat;
            mask-size: contain;
        }

        .control-btn.liked::before {
            background: white;
        }

        .control-btn.heart::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z'/%3E%3C/svg%3E");
        }

        .control-btn.next::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z'/%3E%3C/svg%3E");
        }

        .play-btn {
            width: 42px;
            height: 42px;
            background: var(--gradient-primary);
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: var(--shadow-lg);
            flex-shrink: 0;
        }

        .play-btn:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-xl), var(--glow-primary);
        }

        .play-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 18px;
            height: 18px;
            background: white;
            mask-position: center;
            mask-repeat: no-repeat;
            mask-size: contain;
            transition: all 0.3s ease;
        }

        .play-btn.playing::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M6 19h4V5H6v14zm8-14v14h4V5h-4z'/%3E%3C/svg%3E");
        }

        .play-btn:not(.playing)::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M8 5v14l11-7z'/%3E%3C/svg%3E");
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 70px;
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--border);
            display: flex;
            padding: 0;
            z-index: 1000;
        }

        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 10px 0;
            transition: all 0.2s ease;
            position: relative;
            min-height: 70px;
        }

        .nav-item:hover {
            color: var(--text-primary);
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 0 0 2px 2px;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            margin-bottom: 5px;
            background: currentColor;
            mask-position: center;
            mask-repeat: no-repeat;
            mask-size: contain;
        }

        .nav-item:nth-child(1) .nav-icon {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z'/%3E%3C/svg%3E");
        }

        .nav-item:nth-child(2) .nav-icon {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8 12.5v-9l6 4.5-6 4.5z'/%3E%3C/svg%3E");
        }

        .nav-label {
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        /* Scrollbar */
        .main-content::-webkit-scrollbar {
            width: 5px;
        }

        .main-content::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        .main-content::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }

        .main-content::-webkit-scrollbar-thumb:hover {
            background: var(--primary-light);
        }

        /* ИКОНКИ ДЛЯ КОЛЛЕКЦИЙ */
        .collection-icon {
            width: 14px;
            height: 14px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 3px;
            vertical-align: middle;
        }

        .icon-tracks {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23666666'%3E%3Cpath d='M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z'/%3E%3C/svg%3E") center/contain no-repeat;
        }

        .icon-plays {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23666666'%3E%3Cpath d='M8 5v14l11-7z'/%3E%3C/svg%3E") center/contain no-repeat;
        }

        /* Уведомления */
        .notification {
            position: fixed;
            top: 70px;
            right: 15px;
            background: var(--blue);
            color: white;
            padding: 10px 16px;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            z-index: 9999;
            animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s;
            max-width: 280px;
            word-wrap: break-word;
            font-size: 13px;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Фон -->
    <div class="particles-bg"></div>
    <div class="gradient-layer"></div>

    <!-- Header -->
    <div class="header">
        <div class="header-left">
            <button class="settings-btn" title="Настройки" onclick="openSettings()"></button>
        </div>

        <div class="search-bar">
            <div class="search-icon"></div>
            <input type="text" class="search-input" placeholder="Найти треки, исполнителей, альбомы">
        </div>

        <div class="header-right">
            <div class="user-avatar" id="userAvatar" onclick="showUserMenu()">
                <div class="user-avatar-placeholder">A</div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="content-wrapper">
            <!-- Главная страница -->
            <div class="main-page" id="mainPage">
                <!-- Главная секция - Мой ритм -->
                <div class="sound-hero-section">
                    <h1 class="sound-hero-title">МОЙ РИТМ</h1>
                    <div class="sound-hero-subtitle">
                        Персональные рекомендации на основе ваших предпочтений
                    </div>

                    <!-- Анимация полос -->
                    <div class="sound-visualizer" id="soundVisualizer"></div>

                    <div class="sound-hero-actions">
                        <button class="hero-action-btn primary" onclick="configureSound()">
                            Настроить звук
                        </button>
                        <button class="hero-action-btn secondary" onclick="playSound()">
                            Слушать
                        </button>
                    </div>

                    <!-- СЛАЙДЕР ЗАМЕНЯЕТ РЕКЛАМУ -->
                    <div class="slider-wrapper">
                        <button class="close-btn" onclick="this.parentElement.style.display='none'">×</button>

                        <div class="slides-container" id="slider">
                            <!-- Slide 1 -->
                            <div class="slide slide-music">
                                <div class="slider-content">
                                    <div class="slider-title">Слушай музыку когда<br>отключат интернет</div>
                                    <a href="#" class="slider-link">Узнать подробнее ›</a>
                                </div>
                                <div class="stage-music">
                                    <div style="position:relative; width:45px; height:45px; display:flex; justify-content:center; align-items:center;">
                                        <div class="wifi">
                                            <div class="bar b1"></div>
                                            <div class="bar b2"></div>
                                            <div class="bar b3"></div>
                                            <div class="bar b4"></div>
                                        </div>
                                        <div class="cross-sticker">
                                            <svg viewBox="0 0 100 100">
                                                <path d="M25,25 L75,75 M75,25 L25,75" stroke="#ff3b30" stroke-width="15" stroke-linecap="round" />
                                            </svg>
                                        </div>
                                    </div>
                                    <div class="human-box">
                                        <div class="note" style="left: -5px; top: 0; animation-delay: 0s; color: #ffeb3b;">♪</div>
                                        <div class="note" style="left: 20px; top: -10px; animation-delay: 0.7s; color: #00e5ff;">♫</div>
                                        <div class="note" style="right: -5px; top: 0; animation-delay: 1.4s; color: #ff4081;">♬</div>
                                        <svg viewBox="0 0 100 100">
                                            <circle cx="50" cy="55" r="30" fill="#ffdbac" />
                                            <path d="M20,55 Q20,20 50,20 Q80,20 80,55" fill="none" stroke="#000" stroke-width="10" />
                                            <rect x="10" y="48" width="14" height="22" rx="4" fill="#bb86fc" stroke="#000" stroke-width="5" />
                                            <rect x="76" y="48" width="14" height="22" rx="4" fill="#bb86fc" stroke="#000" stroke-width="5" />
                                            <path d="M45,75 Q50,80 55,75" fill="none" stroke="#000" stroke-width="4" />
                                        </svg>
                                    </div>
                                </div>
                            </div>

                            <!-- Slide 2 -->
                            <div class="slide slide-gem">
                                <div class="slider-content">
                                    <div class="slider-title">Оформи подписку и получи дополнительные возможности</div>
                                    <a href="#" class="slider-link">Узнать подробнее ›</a>
                                </div>
                                <div class="gem-stage">
                                    <div class="sparkle" style="top:20%; left:10%;"></div>
                                    <div class="sparkle" style="bottom:10%; right:20%; animation-delay:0.5s;"></div>
                                    <div class="sparkle" style="top:50%; left:85%; animation-delay:1s;"></div>
                                    <div class="orbit" style="width:75px; height:25px;"></div>
                                    <div class="orbit" style="width:55px; height:35px; border-color:#fff; animation-duration:2s;"></div>
                                    <div class="diamond">💎</div>
                                </div>
                            </div>

                            <!-- Slide 3 -->
                            <div class="slide slide-crypto">
                                <div class="slider-content">
                                    <div class="slider-title">Оплачивай любой криптовалютой и получи скидку</div>
                                    <a href="#" class="slider-link">Узнать подробнее ›</a>
                                </div>
                                <div class="crypto-stage">
                                    <div class="confetti" style="background:#ffeb3b; top:20px; right:150px;"></div>
                                    <div class="confetti" style="background:#00e5ff; bottom:20px; right:100px; animation-delay:1s;"></div>

                                    <div class="coin-3d c-btc">₿</div>
                                    <!-- TON монета -->
                                    <div class="coin-3d c-ton">
                                        <svg viewBox="0 0 100 100" fill="none">
                                            <circle cx="50" cy="50" r="50" fill="#0098EA"/>
                                            <path d="M72 36C72 31.5 68.5 28 64 28H36C31.5 28 28 31.5 28 36V38C28 39.5 28.5 41 29.5 42L47.5 69C48.5 70.5 51.5 70.5 52.5 69L70.5 42C71.5 41 72 39.5 72 38V36Z" stroke="white" stroke-width="6" stroke-linejoin="round"/>
                                            <path d="M50 28V68" stroke="white" stroke-width="6" stroke-linecap="round"/>
                                        </svg>
                                    </div>
                                    <div class="coin-3d c-usdt">₮</div>
                                    <div class="coin-3d c-eth">Ξ</div>
                                </div>
                            </div>
                        </div>

                        <div class="slider-dots">
                            <div class="dot active"></div>
                            <div class="dot"></div>
                            <div class="dot"></div>
                        </div>
                    </div>
                    <!-- КОНЕЦ СЛАЙДЕРА -->

                </div>

                <!-- Подборки музыки -->
                <div class="moods-section">
                    <h2 class="section-title">Подборки музыки</h2>
                    <div class="moods-grid">
                        <div class="mood-card" onclick="openCategory('genres')">
                            <div class="mood-title">
                                <div class="mood-icon"></div>
                                Жанры
                            </div>
                            <div class="mood-subtitle">Рок, поп, хип-хоп, джаз, электроника</div>
                        </div>
                        <div class="mood-card" onclick="openCategory('activities')">
                            <div class="mood-title">
                                <div class="mood-icon"></div>
                                Занятия
                            </div>
                            <div class="mood-subtitle">Для работы, тренировки, отдыха, учебы</div>
                        </div>
                        <div class="mood-card" onclick="openCategory('moods')">
                            <div class="mood-title">
                                <div class="mood-icon"></div>
                                Настроения
                            </div>
                            <div class="mood-subtitle">Веселое, грустное, энергичное, спокойное</div>
                        </div>
                    </div>
                </div>

                <!-- Табы контента -->
                <div class="content-tabs">
                    <button class="tab active" onclick="switchTab('for-you')">Для вас</button>
                    <button class="tab" onclick="switchTab('trends')">Тренды</button>
                    <button class="tab" onclick="switchTab('new')">Новинки</button>
                </div>

                <!-- Контент для таба "Для вас" - НОВАЯ СТРУКТУРА С КОЛОНКАМИ -->
                <div class="tab-content active" id="tab-for-you">
                    <div class="for-you-section">
                        <div class="for-you-header">
                            <div>
                                <div class="for-you-title">На основе ваших предпочтений</div>
                                <div class="for-you-subtitle">Треки, которые вам понравятся</div>
                            </div>
                            <div class="scroll-buttons">
                                <button class="scroll-btn prev" onclick="scrollTracksColumns('prev')"></button>
                                <button class="scroll-btn next" onclick="scrollTracksColumns('next')"></button>
                            </div>
                        </div>

                        <!-- УЛУЧШЕННЫЙ КОНТЕЙНЕР ДЛЯ КОЛОНОК -->
                        <div class="tracks-columns-container" id="tracksColumnsContainer">
                            <!-- Колонки заполняются динамически -->
                        </div>

                        <!-- ИНДИКАТОРЫ ПРОКРУТКИ - ТОЧКИ -->
                        <div class="scroll-indicators" id="scrollIndicators">
                            <!-- Точки заполняются динамически -->
                        </div>
                    </div>
                </div>

                <!-- Контент для таба "Тренды" - АЛЬБОМЫ -->
                <div class="tab-content" id="tab-trends">
                    <div class="collections-grid" id="grid-trends">
                        <!-- Заполняется динамически -->
                    </div>
                </div>

                <!-- Контент для таба "Новинки" - АЛЬБОМЫ -->
                <div class="tab-content" id="tab-new">
                    <div class="collections-grid" id="grid-new">
                        <!-- Заполняется динамически -->
                    </div>
                </div>
            </div>

            <!-- Страница настроек -->
            <div class="settings-page" id="settingsPage">
                <button class="back-btn" onclick="goBack()">
                    ← Назад
                </button>

                <!-- Язык -->
                <div class="settings-section">
                    <h2 class="settings-title language">Язык</h2>
                    <div class="languages-grid" id="languagesGrid">
                        <!-- Заполняется динамически -->
                    </div>
                </div>

                <!-- Техподдержка -->
                <div class="settings-section">
                    <h2 class="settings-title support">Техподдержка</h2>
                    <div class="support-options">
                        <div class="support-option" onclick="contactSupport('chat')">
                            <div class="support-icon"></div>
                            <div class="support-info">
                                <div class="support-title">Онлайн-чат</div>
                                <div class="support-description">Быстрые ответы на ваши вопросы 24/7</div>
                            </div>
                        </div>
                        <div class="support-option" onclick="contactSupport('email')">
                            <div class="support-icon"></div>
                            <div class="support-info">
                                <div class="support-title">Email поддержка</div>
                                <div class="support-description">Подробные ответы на complex@support.myrhythm.com</div>
                            </div>
                        </div>
                        <div class="support-option" onclick="openFAQ()">
                            <div class="support-icon"></div>
                            <div class="support-info">
                                <div class="support-title">FAQ и помощь</div>
                                <div class="support-description">Ответы на часто задаваемые вопросы</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Управление подпиской -->
                <div class="settings-section">
                    <div class="subscription-header">
                        <h1 class="subscription-title" id="subscriptionTitleText">ПОДПИСКА</h1>
                        <div class="subscription-subtitle" id="subscriptionSubtitleText">
                            Выберите подходящий план подписки
                        </div>
                    </div>

                    <div class="subscription-plans" id="subscriptionPlans">
                        <!-- Заполняется динамически -->
                    </div>

                    <!-- Контейнер для промокода -->
                    <div class="promocode-container">
                        <div class="promocode-title">Промокод</div>
                        <div class="promocode-input-container">
                            <input type="text" class="promocode-input" placeholder="Введите промокод" id="promocodeInput">
                            <button class="promocode-btn" onclick="applyPromocode()">Применить</button>
                        </div>
                        <div class="promocode-description" id="promocodeDescriptionText">
                            Введите промокод для получения скидки на подписку
                        </div>
                    </div>
                </div>
            </div>

            <!-- Страница коллекции -->
            <div class="collection-page" id="collectionPage">
                <button class="back-btn" onclick="goBack()">
                    ← Назад
                </button>

                <!-- Пока коллекция пуста -->
                <div class="empty-collection" id="emptyCollection" style="display: block;">
                    <div class="empty-icon">🎵</div>
                    <div class="empty-title">Коллекция пуста</div>
                    <div class="empty-subtitle">
                        Чтобы добавить трек в коллекцию, нажмите на сердечко ❤️ рядом с ним
                    </div>
                </div>

                <!-- Когда появляются треки -->
                <div class="collection-grid" id="collectionGrid" style="display: none;">
                    <!-- Заполняется динамически при добавлении треков -->
                </div>
            </div>

            <!-- Страница альбома -->
            <div class="album-page" id="albumPage">
                <button class="back-btn" onclick="goBack()">
                    ← Назад
                </button>
                <div class="album-header" id="albumHeader">
                    <!-- Заполняется динамически -->
                </div>
                <div class="tracks-list-section">
                    <div class="tracks-list-title">Треки</div>
                    <div class="tracks-container" id="tracksList">
                        <!-- Заполняется динамически -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Player -->
    <div class="player">
        <div class="player-cover"></div>
        <div class="player-info">
            <div class="player-title">Выберите трек</div>
            <div class="player-artist">Нажмите на трек или альбом</div>
        </div>
        <div class="player-controls">
            <button class="control-btn heart" id="playerHeartBtn"></button>
            <button class="play-btn" id="playerPlayBtn"></button>
            <button class="control-btn next"></button>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <button class="nav-item active" onclick="switchPage('music')">
            <div class="nav-icon"></div>
            <div class="nav-label">Музыка</div>
        </button>
        <button class="nav-item" onclick="switchPage('collection')">
            <div class="nav-icon"></div>
            <div class="nav-label">Коллекция</div>
        </button>
    </div>

    <script>
        // Состояние приложения
        let currentPage = 'music';
        let currentTab = 'for-you';
        let currentAlbum = null;
        let currentTrack = null;
        let isPlaying = false;
        let soundConfigured = false;
        let userPreferences = [];
        let likedTracks = new Set();
        let currentLanguage = 'ru';
        let currentColumnIndex = 0;

        // Тестовые изображения
        const testImages = [
            'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1511379938547-c1f69419868d?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1518609878373-06d740f60d8b?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1519281682544-5b00a8dc84ea?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1487180144351-b8472da7d491?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1529255484355-cb73c33c04bb?w=400&h=400&fit=crop'
        ];

        // Треки для раздела "Для вас" - теперь 12 треков
        const forYouTracks = [
            {
                id: 'fy-1',
                title: 'Рассвет',
                artist: 'Miyagi & Andy Panda',
                album: 'Yamakasi',
                duration: '3:45',
                year: 2024,
                plays: '2.5M',
                mood: 'Спокойное',
                genre: 'Хип-хоп',
                image: testImages[0]
            },
            {
                id: 'fy-2',
                title: 'Энергия',
                artist: 'The Weeknd',
                album: 'Dawn FM',
                duration: '4:20',
                year: 2023,
                plays: '5.1M',
                mood: 'Энергичное',
                genre: 'Поп',
                image: testImages[1]
            },
            {
                id: 'fy-3',
                title: 'Дорога',
                artist: 'Кис-кис',
                album: 'Между нами',
                duration: '3:15',
                year: 2024,
                plays: '1.8M',
                mood: 'Путешествие',
                genre: 'Рок',
                image: testImages[2]
            },
            {
                id: 'fy-4',
                title: 'Тишина',
                artist: 'Billie Eilish',
                album: 'Happier Than Ever',
                duration: '4:05',
                year: 2023,
                plays: '3.2M',
                mood: 'Спокойное',
                genre: 'Поп',
                image: testImages[3]
            },
            {
                id: 'fy-5',
                title: 'Фокус',
                artist: 'Hans Zimmer',
                album: 'Interstellar OST',
                duration: '5:30',
                year: 2024,
                plays: '1.2M',
                mood: 'Концентрация',
                genre: 'Саундтрек',
                image: testImages[4]
            },
            {
                id: 'fy-6',
                title: 'Воспоминания',
                artist: 'Макс Корж',
                album: 'Малый повзрослел',
                duration: '3:50',
                year: 2024,
                plays: '4.3M',
                mood: 'Ностальгия',
                genre: 'Поп',
                image: testImages[5]
            },
            {
                id: 'fy-7',
                title: 'Лето',
                artist: 'Монеточка',
                album: 'Раскраски для взрослых',
                duration: '2:55',
                year: 2024,
                plays: '2.1M',
                mood: 'Веселое',
                genre: 'Поп',
                image: testImages[6]
            },
            {
                id: 'fy-8',
                title: 'Ночь',
                artist: 'LSP',
                album: 'Tragic City',
                duration: '4:10',
                year: 2024,
                plays: '3.8M',
                mood: 'Вечернее',
                genre: 'Хип-хоп',
                image: testImages[7]
            },
            {
                id: 'fy-9',
                title: 'Город',
                artist: 'Noize MC',
                album: 'Царь горы',
                duration: '3:25',
                year: 2024,
                plays: '2.7M',
                mood: 'Городское',
                genre: 'Хип-хоп',
                image: testImages[0]
            },
            {
                id: 'fy-10',
                title: 'Океан',
                artist: 'Imagine Dragons',
                album: 'Mercury',
                duration: '4:15',
                year: 2023,
                plays: '3.5M',
                mood: 'Эпическое',
                genre: 'Рок',
                image: testImages[1]
            },
            {
                id: 'fy-11',
                title: 'Мечта',
                artist: 'BTS',
                album: 'Love Yourself',
                duration: '3:45',
                year: 2024,
                plays: '4.8M',
                mood: 'Вдохновляющее',
                genre: 'K-pop',
                image: testImages[2]
            },
            {
                id: 'fy-12',
                title: 'Полет',
                artist: 'M83',
                album: 'Hurry Up',
                duration: '5:10',
                year: 2024,
                plays: '1.9M',
                mood: 'Космическое',
                genre: 'Электроника',
                image: testImages[3]
            }
        ];

        // Альбомы для разделов "Тренды" и "Новинки"
        const albumsDatabase = {
            trends: [
                {
                    id: 'trend-1',
                    title: 'Громкие новинки месяца',
                    artist: 'Их ждали!',
                    plays: '8.2M',
                    tracks: 3,
                    year: 2024,
                    type: 'Сборник',
                    duration: '12:45',
                    badge: 'trending',
                    image: testImages[0],
                    tracksList: [
                        {
                            id: 't1-1',
                            title: 'Аста ла виста',
                            artist: 'Окрытонит, FEDUK',
                            album: 'Громкие новинки месяца',
                            duration: '3:15',
                            year: 2024,
                            plays: '4.2M',
                            image: testImages[0],
                            mood: 'Энергичное',
                            genre: 'Хип-хоп',
                            description: 'Популярный хит от дуэта Окрытонит и FEDUK'
                        },
                        {
                            id: 't1-2',
                            title: 'Романтик и Вандал',
                            artist: 'BIUSHDO ZHO',
                            album: 'Громкие новинки месяца',
                            duration: '4:30',
                            year: 2024,
                            plays: '3.1M',
                            image: testImages[1],
                            mood: 'Эмоциональное',
                            genre: 'Хип-хоп',
                            description: 'Глубокий трек от BIUSHDO ZHO'
                        },
                        {
                            id: 't1-3',
                            title: 'БЕСИТСЯ',
                            artist: 'ToxiS, Big Baby Tape',
                            album: 'Громкие новинки месяца',
                            duration: '5:00',
                            year: 2024,
                            plays: '2.8M',
                            image: testImages[2],
                            mood: 'Агрессивное',
                            genre: 'Хип-хоп',
                            description: 'Энергичная коллаборация ToxiS и Big Baby Tape'
                        }
                    ]
                },
                {
                    id: 'trend-2',
                    title: 'TikTok хиты',
                    artist: 'Вирусные треки',
                    plays: '12.4M',
                    tracks: 5,
                    year: 2024,
                    type: 'Плейлист',
                    duration: '18:30',
                    badge: 'trending',
                    image: testImages[1],
                    tracksList: []
                },
                {
                    id: 'trend-3',
                    title: '2024 Чарты',
                    artist: 'Популярное',
                    plays: '6.9M',
                    tracks: 4,
                    year: 2024,
                    type: 'Сборник',
                    duration: '15:45',
                    badge: 'trending',
                    image: testImages[2],
                    tracksList: []
                }
            ],
            new: [
                {
                    id: 'new-1',
                    title: 'Свежие релизы',
                    artist: 'Новинки недели',
                    plays: '2.1M',
                    tracks: 3,
                    year: 2024,
                    type: 'Сборник',
                    duration: '10:30',
                    badge: 'new',
                    image: testImages[3],
                    tracksList: []
                },
                {
                    id: 'new-2',
                    title: 'Только вышло',
                    artist: 'Новый месяц',
                    plays: '1.8M',
                    tracks: 2,
                    year: 2024,
                    type: 'Плейлист',
                    duration: '7:50',
                    badge: 'new',
                    image: testImages[4],
                    tracksList: []
                },
                {
                    id: 'new-3',
                    title: 'Эксклюзив',
                    artist: 'MyRhythm',
                    plays: '3.2M',
                    tracks: 2,
                    year: 2024,
                    type: 'Эксклюзив',
                    duration: '8:15',
                    badge: 'new',
                    image: testImages[5],
                    tracksList: []
                }
            ]
        };

        // Только русский и английский языки
        const languages = [
            { code: 'ru', name: 'Русский', native: 'Русский', flag: 'https://flagcdn.com/w320/ru.png' },
            { code: 'en', name: 'Английский', native: 'English', flag: 'https://flagcdn.com/w320/gb.png' }
        ];

        // Переводы для интерфейса (только русский и английский)
        const translations = {
            ru: {
                searchPlaceholder: 'Найти треки, исполнителей, альбомы',
                soundHeroTitle: 'МОЙ РИТМ',
                soundHeroSubtitle: 'Персональные рекомендации на основе ваших предпочтений',
                configureSound: 'Настроить звук',
                listen: 'Слушать',
                musicCollections: 'Подборки музыки',
                genres: 'Жанры',
                genresDesc: 'Рок, поп, хип-хоп, джаз, электроника',
                activities: 'Занятия',
                activitiesDesc: 'Для работы, тренировки, отдыха, учебы',
                moods: 'Настроения',
                moodsDesc: 'Веселое, грустное, энергичное, спокойное',
                forYou: 'Для вас',
                trends: 'Тренды',
                new: 'Новинки',
                basedOnPreferences: 'На основе ваших предпочтений',
                tracksYouWillLike: 'Треки, которые вам понравятся',
                trackCount: 'треков',
                plays: 'прослушиваний',
                trending: 'ТРЕНД',
                newBadge: 'НОВОЕ',
                back: '← Назад',
                language: 'Язык',
                support: 'Техподдержка',
                onlineChat: 'Онлайн-чат',
                onlineChatDesc: 'Быстрые ответы на ваши вопросы 24/7',
                emailSupport: 'Email поддержка',
                emailSupportDesc: 'Подробные ответы на complex@support.myrhythm.com',
                faqHelp: 'FAQ и помощь',
                faqHelpDesc: 'Ответы на часто задаваемые вопросы',
                subscriptionTitle: 'ПОДПИСКА',
                subscriptionSubtitle: 'Выберите подходящий план подписки',
                year: 'ГОД',
                halfYear: 'ПОЛГОДА',
                month: 'МЕСЯЦ',
                buySubscription: 'КУПИТЬ ПОДПИСКУ',
                bestPrice: 'ЛУЧШАЯ ЦЕНА',
                economy: 'Экономия',
                collectionTitle: 'МОЯ КОЛЛЕКЦИЯ',
                collectionSubtitle: 'Все ваши сохраненные треки, плейлисты и альбомы в одном месте',
                emptyCollection: 'Коллекция пуста',
                emptyCollectionDesc: 'Чтобы добавить трек в коллекцию, нажмите на сердечко ❤️ рядом с ним',
                selectTrack: 'Выберите трек',
                clickTrack: 'Нажмите на трек или альбом',
                music: 'Музыка',
                collection: 'Коллекция',
                promocodeDesc: 'Введите промокод для получения скидки на подписку',
                // Особенности подписок на русском
                feature1: 'Высокое качество звука',
                feature2: 'Скачивание треков',
                feature3: 'Прослушивание без рекламы',
                feature4: 'Персональные рекомендации',
                feature5: 'Эксклюзивный контент',
                feature6: 'Приоритетная поддержка',
                feature7: 'Ограниченное скачивание',
                feature8: 'Базовые рекомендации',
                feature9: 'Стандартное качество',
                feature10: 'Без скачивания',
                // Убрали надпись для популярного выбора
                popularChoice: ''
            },
            en: {
                searchPlaceholder: 'Search tracks, artists, albums',
                soundHeroTitle: 'MY RHYTHM',
                soundHeroSubtitle: 'Personal recommendations based on your preferences',
                configureSound: 'Configure Sound',
                listen: 'Listen',
                musicCollections: 'Music Collections',
                genres: 'Genres',
                genresDesc: 'Rock, pop, hip-hop, jazz, electronic',
                activities: 'Activities',
                activitiesDesc: 'For work, workout, rest, study',
                moods: 'Moods',
                moodsDesc: 'Happy, sad, energetic, calm',
                forYou: 'For You',
                trends: 'Trends',
                new: 'New',
                basedOnPreferences: 'Based on your preferences',
                tracksYouWillLike: 'Tracks you will like',
                trackCount: 'tracks',
                plays: 'plays',
                trending: 'TRENDING',
                newBadge: 'NEW',
                back: '← Back',
                language: 'Language',
                support: 'Support',
                onlineChat: 'Online Chat',
                onlineChatDesc: 'Quick answers to your questions 24/7',
                emailSupport: 'Email Support',
                emailSupportDesc: 'Detailed answers to complex@support.myrhythm.com',
                faqHelp: 'FAQ & Help',
                faqHelpDesc: 'Answers to frequently asked questions',
                subscriptionTitle: 'SUBSCRIPTION',
                subscriptionSubtitle: 'Choose the right subscription plan',
                year: 'YEAR',
                halfYear: 'HALF YEAR',
                month: 'MONTH',
                buySubscription: 'BUY SUBSCRIPTION',
                bestPrice: 'BEST PRICE',
                economy: 'Save',
                collectionTitle: 'MY COLLECTION',
                collectionSubtitle: 'All your saved tracks, playlists and albums in one place',
                emptyCollection: 'Collection is empty',
                emptyCollectionDesc: 'To add a track to collection, click the heart ❤️ next to it',
                selectTrack: 'Select track',
                clickTrack: 'Click on track or album',
                music: 'Music',
                collection: 'Collection',
                promocodeDesc: 'Enter promo code to get discount on subscription',
                // Особенности подписок на английском
                feature1: 'High quality sound',
                feature2: 'Download tracks',
                feature3: 'Listening without ads',
                feature4: 'Personal recommendations',
                feature5: 'Exclusive content',
                feature6: 'Priority support',
                feature7: 'Limited downloads',
                feature8: 'Basic recommendations',
                feature9: 'Standard quality',
                feature10: 'No downloads',
                // Убрали надпись для популярного выбора
                popularChoice: ''
            }
        };

        // ПОДПИСКИ С ПЕРЕВОДАМИ - БЕЗ ОРАНЖЕВЫХ ПОЛОСОК
        const subscriptionPlans = {
            ru: [
                {
                    id: 'yearly',
                    period: 'ГОД',
                    price: '4.99',
                    savings: 'Экономия 50%',
                    features: [
                        translations.ru.feature1,
                        translations.ru.feature2,
                        translations.ru.feature3,
                        translations.ru.feature4,
                        translations.ru.feature5,
                        translations.ru.feature6
                    ],
                    popular: true
                },
                {
                    id: 'half-year',
                    period: 'ПОЛГОДА',
                    price: '2.99',
                    savings: 'Экономия 40%',
                    features: [
                        translations.ru.feature1,
                        translations.ru.feature7,
                        translations.ru.feature3,
                        translations.ru.feature4,
                        translations.ru.feature6
                    ],
                    popular: false
                },
                {
                    id: 'monthly',
                    period: 'МЕСЯЦ',
                    price: '0.99',
                    savings: '',
                    features: [
                        translations.ru.feature9,
                        translations.ru.feature10,
                        translations.ru.feature3,
                        translations.ru.feature8
                    ],
                    popular: false
                }
            ],
            en: [
                {
                    id: 'yearly',
                    period: 'YEAR',
                    price: '4.99',
                    savings: 'Save 50%',
                    features: [
                        translations.en.feature1,
                        translations.en.feature2,
                        translations.en.feature3,
                        translations.en.feature4,
                        translations.en.feature5,
                        translations.en.feature6
                    ],
                    popular: true
                },
                {
                    id: 'half-year',
                    period: 'HALF YEAR',
                    price: '2.99',
                    savings: 'Save 40%',
                    features: [
                        translations.en.feature1,
                        translations.en.feature7,
                        translations.en.feature3,
                        translations.en.feature4,
                        translations.en.feature6
                    ],
                    popular: false
                },
                {
                    id: 'monthly',
                    period: 'MONTH',
                    price: '0.99',
                    savings: '',
                    features: [
                        translations.en.feature9,
                        translations.en.feature10,
                        translations.en.feature3,
                        translations.en.feature8
                    ],
                    popular: false
                }
            ]
        };

        // ИКОНКА TON
        function createTonIcon(size = '20px') {
            return `
                <svg width="${size}" height="${size}" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="50" cy="50" r="50" fill="#0098EA"/>
                    <path d="M72 36C72 31.5 68.5 28 64 28H36C31.5 28 28 31.5 28 36V38C28 39.5 28.5 41 29.5 42L47.5 69C48.5 70.5 51.5 70.5 52.5 69L70.5 42C71.5 41 72 39.5 72 38V36Z" stroke="white" stroke-width="6" stroke-linejoin="round"/>
                    <path d="M50 28V68" stroke="white" stroke-width="6" stroke-linecap="round"/>
                </svg>
            `;
        }

        // Инициализация
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            createVisualizerBars();
            loadTracksColumns();
            loadTabContent('trends');
            loadTabContent('new');
            loadLanguages();
            loadSubscriptionPlans();
            updateInterfaceLanguage();
            setupSlider();
            setupTouchScrolling();
        });

        // Настройка слайдера
        function setupSlider() {
            const slider = document.getElementById('slider');
            const dots = document.querySelectorAll('.slider-dots .dot');
            
            if (!slider) return;

            slider.addEventListener('scroll', () => {
                const index = Math.round(slider.scrollLeft / slider.offsetWidth);
                dots.forEach((dot, i) => {
                    dot.classList.toggle('active', i === index);
                });
            });

            // Автопрокрутка слайдера
            let currentSlide = 0;
            setInterval(() => {
                if (!document.querySelector('.slider-wrapper').style.display) {
                    currentSlide = (currentSlide + 1) % 3;
                    slider.scrollTo({
                        left: currentSlide * slider.offsetWidth,
                        behavior: 'smooth'
                    });
                }
            }, 5000);

            // Блокировка вертикального скролла на мобильных
            slider.addEventListener('touchmove', function(e) {
                if (e.touches.length > 0) {
                    e.preventDefault();
                }
            }, { passive: false });
        }

        // Создание визуализатора полос
        function createVisualizerBars() {
            const visualizer = document.getElementById('soundVisualizer');
            if (!visualizer) return;

            visualizer.innerHTML = '';
            for (let i = 0; i < 12; i++) {
                const bar = document.createElement('div');
                bar.className = 'visualizer-bar';
                bar.style.height = `${12 + Math.random() * 38}px`;
                bar.style.animationDelay = `${i * 0.1}s`;
                visualizer.appendChild(bar);
            }
        }

        // НОВАЯ ФУНКЦИЯ: Загрузка треков в колонки
        function loadTracksColumns() {
            const container = document.getElementById('tracksColumnsContainer');
            const indicators = document.getElementById('scrollIndicators');
            if (!container || !indicators) return;

            container.innerHTML = '';
            indicators.innerHTML = '';

            // Разделяем треки на колонки по 3 трека в каждой
            const tracksPerColumn = 3;
            const columnCount = Math.ceil(forYouTracks.length / tracksPerColumn);

            // Создаем индикаторы
            for (let i = 0; i < columnCount; i++) {
                const dot = document.createElement('div');
                dot.className = `scroll-indicator-dot ${i === 0 ? 'active' : ''}`;
                dot.onclick = () => scrollToColumn(i);
                indicators.appendChild(dot);
            }

            for (let colIndex = 0; colIndex < columnCount; colIndex++) {
                const column = document.createElement('div');
                column.className = 'tracks-column';

                const startIndex = colIndex * tracksPerColumn;
                const endIndex = Math.min(startIndex + tracksPerColumn, forYouTracks.length);
                const columnTracks = forYouTracks.slice(startIndex, endIndex);

                columnTracks.forEach(track => {
                    const card = document.createElement('div');
                    card.className = 'track-card-for-you';
                    card.onclick = () => openTrack(track, 'for-you');

                    const img = document.createElement('img');
                    img.className = 'track-image-for-you';
                    img.src = track.image;
                    img.alt = track.title;

                    card.appendChild(img);

                    const infoDiv = document.createElement('div');
                    infoDiv.className = 'track-info-for-you';

                    infoDiv.innerHTML = `
                        <div>
                            <div class="track-title-for-you">${track.title}</div>
                            <div class="track-artist-for-you">${track.artist}</div>
                        </div>
                        <div class="track-meta-for-you">
                            <span>${track.duration}</span>
                            <span>•</span>
                            <span>${track.plays}</span>
                        </div>
                    `;

                    card.appendChild(infoDiv);
                    column.appendChild(card);
                });

                container.appendChild(column);
            }
        }

        // Скролл к конкретной колонке
        function scrollToColumn(index) {
            const container = document.getElementById('tracksColumnsContainer');
            if (!container) return;

            const columnWidth = 350 + 20; // ширина колонки + отступ
            container.scrollTo({
                left: index * columnWidth,
                behavior: 'smooth'
            });

            updateIndicators(index);
        }

        // Обновление индикаторов
        function updateIndicators(index) {
            const indicators = document.getElementById('scrollIndicators');
            if (!indicators) return;

            const dots = indicators.querySelectorAll('.scroll-indicator-dot');
            dots.forEach((dot, i) => {
                if (i === index) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });

            currentColumnIndex = index;
        }

        // УЛУЧШЕННАЯ НАСТРОЙКА ПРОКРУТКИ ПАЛЬЦЕМ
        function setupTouchScrolling() {
            const container = document.getElementById('tracksColumnsContainer');
            if (!container) return;

            let isDragging = false;
            let startX = 0;
            let scrollLeft = 0;
            let velocity = 0;
            let lastX = 0;
            let lastTime = 0;
            let animationId = null;
            let isScrolling = false;

            // Мышь события для десктопа
            container.addEventListener('mousedown', (e) => {
                // Проверяем, был ли клик по треку
                if (e.target.closest('.track-card-for-you')) {
                    return; // Не начинаем перетаскивание, если кликнули по треку
                }

                isDragging = true;
                startX = e.pageX - container.offsetLeft;
                scrollLeft = container.scrollLeft;
                container.style.cursor = 'grabbing';
                container.style.scrollBehavior = 'auto';

                // Сброс анимации
                if (animationId) {
                    cancelAnimationFrame(animationId);
                    animationId = null;
                }

                velocity = 0;
                lastX = e.pageX;
                lastTime = Date.now();

                // Отменяем выделение текста
                e.preventDefault();
            });

            container.addEventListener('mouseleave', () => {
                if (isDragging) {
                    isDragging = false;
                    container.style.cursor = 'grab';
                    container.style.scrollBehavior = 'smooth';

                    // Запускаем инерцию при отпускании
                    applyInertia();
                }
            });

            container.addEventListener('mouseup', () => {
                if (isDragging) {
                    isDragging = false;
                    container.style.cursor = 'grab';
                    container.style.scrollBehavior = 'smooth';

                    // Запускаем инерцию при отпускании
                    applyInertia();
                }
            });

            container.addEventListener('mousemove', (e) => {
                if (!isDragging || isScrolling) return;
                e.preventDefault();

                const x = e.pageX - container.offsetLeft;
                const walk = (x - startX) * 1.5;
                container.scrollLeft = scrollLeft - walk;

                // Собираем данные для инерции
                const currentTime = Date.now();
                if (currentTime !== lastTime) {
                    velocity = (x - lastX) / (currentTime - lastTime);
                }
                lastX = x;
                lastTime = currentTime;
            });

            // Touch события для мобильных устройств
            container.addEventListener('touchstart', (e) => {
                // Проверяем, было ли касание по треку
                if (e.target.closest('.track-card-for-you')) {
                    return; // Не начинаем перетаскивание, если коснулись трека
                }

                isDragging = true;
                startX = e.touches[0].pageX - container.offsetLeft;
                scrollLeft = container.scrollLeft;
                container.style.scrollBehavior = 'auto';

                // Сброс анимации
                if (animationId) {
                    cancelAnimationFrame(animationId);
                    animationId = null;
                }

                velocity = 0;
                lastX = e.touches[0].pageX;
                lastTime = Date.now();
            }, { passive: true });

            container.addEventListener('touchmove', (e) => {
                if (!isDragging || isScrolling) return;
                e.preventDefault();

                const x = e.touches[0].pageX - container.offsetLeft;
                const walk = (x - startX) * 1.5;
                container.scrollLeft = scrollLeft - walk;

                // Собираем данные для инерции
                const currentX = e.touches[0].pageX;
                const currentTime = Date.now();
                if (currentTime !== lastTime) {
                    velocity = (currentX - lastX) / (currentTime - lastTime);
                }
                lastX = currentX;
                lastTime = currentTime;
            }, { passive: false });

            container.addEventListener('touchend', () => {
                if (isDragging) {
                    isDragging = false;
                    container.style.scrollBehavior = 'smooth';

                    // Запускаем инерцию
                    applyInertia();
                }
            });

            container.addEventListener('touchcancel', () => {
                if (isDragging) {
                    isDragging = false;
                    container.style.scrollBehavior = 'smooth';

                    // Запускаем инерцию
                    applyInertia();
                }
            });

            // Функция инерции
            function applyInertia() {
                if (Math.abs(velocity) > 0.1) {
                    const inertia = () => {
                        container.scrollLeft -= velocity * 20;
                        velocity *= 0.92;

                        if (Math.abs(velocity) > 0.1) {
                            animationId = requestAnimationFrame(inertia);
                        } else {
                            animationId = null;
                            snapToNearestColumn();
                        }
                    };
                    animationId = requestAnimationFrame(inertia);
                } else {
                    snapToNearestColumn();
                }
            }

            // Автоматическое выравнивание к ближайшей колонке
            function snapToNearestColumn() {
                isScrolling = true;
                const columnWidth = 350 + 20;
                const scrollPosition = container.scrollLeft;
                const columnIndex = Math.round(scrollPosition / columnWidth);

                container.scrollTo({
                    left: columnIndex * columnWidth,
                    behavior: 'smooth'
                });

                // Обновляем индикаторы
                updateIndicators(columnIndex);

                // Сбрасываем флаг после завершения анимации
                setTimeout(() => {
                    isScrolling = false;
                }, 300);
            }

            // Обновление индикаторов при ручной прокрутке
            container.addEventListener('scroll', () => {
                if (!isDragging && !isScrolling) {
                    const columnWidth = 350 + 20;
                    const scrollPosition = container.scrollLeft;
                    const columnIndex = Math.round(scrollPosition / columnWidth);
                    updateIndicators(columnIndex);
                }
            });
        }

        // Скролл для колонок
        function scrollTracksColumns(direction) {
            const container = document.getElementById('tracksColumnsContainer');
            if (!container) return;

            const columnWidth = 350 + 20;
            const currentScroll = container.scrollLeft;

            let targetIndex = currentColumnIndex;
            if (direction === 'prev') {
                targetIndex = Math.max(0, currentColumnIndex - 1);
            } else {
                const maxIndex = Math.ceil(forYouTracks.length / 3) - 1;
                targetIndex = Math.min(maxIndex, currentColumnIndex + 1);
            }

            container.scrollTo({
                left: targetIndex * columnWidth,
                behavior: 'smooth'
            });

            updateIndicators(targetIndex);
        }

        // Загрузка контента для таба
        function loadTabContent(tabId) {
            const grid = document.getElementById(`grid-${tabId}`);
            if (!grid) return;

            const albums = albumsDatabase[tabId];
            if (!albums) return;

            grid.innerHTML = '';

            albums.forEach(album => {
                const card = document.createElement('div');
                card.className = 'collection-card';
                card.onclick = () => openAlbum(album, tabId);

                const badgeText = album.badge === 'trending' ? translations[currentLanguage].trending : 
                                 album.badge === 'new' ? translations[currentLanguage].newBadge : '';

                const badgeClass = album.badge === 'trending' ? 'trending' : 
                                  album.badge === 'new' ? 'new' : '';

                const badge = badgeText ? `<div class="collection-badge ${badgeClass}">${badgeText}</div>` : '';

                card.innerHTML = `
                    <img src="${album.image}" class="collection-image" alt="${album.title}">
                    <div class="collection-info">
                        <div class="collection-title">${album.title}</div>
                        <div class="collection-artist">${album.artist}</div>
                        <div class="collection-stats">
                            <span>
                                <div class="collection-icon icon-tracks"></div>
                                ${album.tracks} ${translations[currentLanguage].trackCount}
                            </span>
                            <span>
                                <div class="collection-icon icon-plays"></div>
                                ${album.plays} ${translations[currentLanguage].plays}
                            </span>
                        </div>
                        ${badge}
                    </div>
                `;

                grid.appendChild(card);
            });
        }

        // Загрузка языков (только русский и английский)
        function loadLanguages() {
            const languagesGrid = document.getElementById('languagesGrid');
            if (!languagesGrid) return;

            languagesGrid.innerHTML = '';

            languages.forEach(lang => {
                const option = document.createElement('div');
                option.className = `language-option ${lang.code === currentLanguage ? 'active' : ''}`;
                option.onclick = () => changeLanguage(lang.code);

                option.innerHTML = `
                    <img src="${lang.flag}" class="language-flag" alt="${lang.name}">
                    <div class="language-info">
                        <div class="language-name">${lang.name}</div>
                        <div class="language-natives">${lang.native}</div>
                    </div>
                `;

                languagesGrid.appendChild(option);
            });
        }

        // Загрузка подписок - БЕЗ ОРАНЖЕВЫХ ПОЛОСОК
        function loadSubscriptionPlans() {
            const plansContainer = document.getElementById('subscriptionPlans');
            if (!plansContainer) return;

            plansContainer.innerHTML = '';

            const plans = subscriptionPlans[currentLanguage];

            plans.forEach(plan => {
                const planCard = document.createElement('div');
                planCard.className = `plan-card ${plan.id} ${plan.popular ? 'popular' : ''}`;

                const featuresHtml = plan.features.map(feature => 
                    `<div class="plan-feature">${feature}</div>`
                ).join('');

                const savingsHtml = plan.savings ? 
                    `<div class="plan-savings">${plan.savings}</div>` : '';

                const periodText = plan.period;
                const buttonText = translations[currentLanguage].buySubscription;

                planCard.innerHTML = `
                    <div class="plan-header">
                        <div class="plan-period">${periodText}</div>
                        <div class="plan-price-container">
                            <div class="plan-price">${plan.price}</div>
                            <div class="plan-currency">
                                <div class="ton-icon">${createTonIcon('20px')}</div>
                                TON
                            </div>
                        </div>
                        ${savingsHtml}
                    </div>
                    <div class="plan-features">
                        ${featuresHtml}
                    </div>
                    <button class="plan-button" onclick="subscribeToPlan('${plan.id}', '${plan.price}')">
                        ${buttonText}
                    </button>
                `;

                // УБРАЛ ДОБАВЛЕНИЕ НАДПИСИ "ПОПУЛЯРНЫЙ ВЫБОР"

                plansContainer.appendChild(planCard);
            });
        }

        // Переключение табов
        function switchTab(tabId) {
            // Обновляем активные классы
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // Активируем выбранный таб
            const activeTab = document.querySelector(`.tab[onclick="switchTab('${tabId}')"]`);
            const activeContent = document.getElementById(`tab-${tabId}`);

            if (activeTab) activeTab.classList.add('active');
            if (activeContent) activeContent.classList.add('active');

            currentTab = tabId;
        }

        // Переключение страниц
        function switchPage(pageId) {
            // Обновляем активные классы навигации
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            const activeNav = document.querySelector(`.nav-item[onclick="switchPage('${pageId}')"]`);
            if (activeNav) activeNav.classList.add('active');

            // Скрываем все страницы
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('settingsPage').style.display = 'none';
            document.getElementById('collectionPage').style.display = 'none';
            document.getElementById('albumPage').style.display = 'none';

            // Показываем выбранную страницу
            switch(pageId) {
                case 'music':
                    document.getElementById('mainPage').style.display = 'block';
                    break;
                case 'settings':
                    document.getElementById('settingsPage').style.display = 'block';
                    break;
                case 'collection':
                    document.getElementById('collectionPage').style.display = 'block';
                    updateCollectionPage();
                    break;
            }

            currentPage = pageId;
        }

        // Обновление страницы коллекции
        function updateCollectionPage() {
            const emptyCollection = document.getElementById('emptyCollection');
            const collectionGrid = document.getElementById('collectionGrid');

            // Получаем все понравившиеся треки
            const likedTracksArray = Array.from(likedTracks).map(trackId => 
                forYouTracks.find(t => t.id === trackId) ||
                albumsDatabase.trends.flatMap(a => a.tracksList).find(t => t?.id === trackId) ||
                albumsDatabase.new.flatMap(a => a.tracksList).find(t => t?.id === trackId)
            ).filter(Boolean);

            if (likedTracksArray.length === 0) {
                emptyCollection.style.display = 'block';
                collectionGrid.style.display = 'none';
            } else {
                emptyCollection.style.display = 'none';
                collectionGrid.style.display = 'grid';

                // Очищаем и заполняем сетку
                collectionGrid.innerHTML = '';

                likedTracksArray.forEach(track => {
                    const item = document.createElement('div');
                    item.className = 'collection-track-item';
                    item.onclick = () => playTrackFromCollection(track);

                    item.innerHTML = `
                        <img src="${track.image}" class="collection-track-image" alt="${track.title}">
                        <div class="collection-track-info">
                            <div class="collection-track-title">${track.title}</div>
                            <div class="collection-track-artist">${track.artist}</div>
                            <div class="collection-track-meta">
                                <span>${track.duration}</span>
                                <span>•</span>
                                <span>${track.year}</span>
                            </div>
                        </div>
                    `;

                    collectionGrid.appendChild(item);
                });
            }
        }

        // Открытие настроек
        function openSettings() {
            switchPage('settings');
        }

        // Открытие трека
        function openTrack(track, source) {
            currentTrack = track;

            // Обновляем плеер
            updatePlayer({
                title: track.title,
                artist: track.artist,
                album: track.album,
                image: track.image,
                isPlaying: true
            });

            // Обновляем состояние сердечка
            const heartBtn = document.getElementById('playerHeartBtn');
            if (heartBtn) {
                heartBtn.classList.toggle('liked', likedTracks.has(track.id));
            }

            // Добавляем в предпочтения
            addToPreferences(track);

            showNotification(`${translations[currentLanguage].selectTrack}: ${track.title} - ${track.artist}`);
        }

        // Открытие альбома
        function openAlbum(album, source) {
            currentAlbum = album;

            // Скрываем все остальное
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('settingsPage').style.display = 'none';
            document.getElementById('collectionPage').style.display = 'none';

            // Показываем страницу альбома
            const albumPage = document.getElementById('albumPage');
            albumPage.classList.add('active');
            albumPage.style.display = 'block';

            const header = document.getElementById('albumHeader');
            header.innerHTML = `
                <img src="${album.image}" class="album-cover-large" alt="${album.title}">
                <div class="album-info">
                    <div class="album-type">${album.type}</div>
                    <h1 class="album-name-large">${album.title}</h1>
                    <div class="album-artist-large">${album.artist}</div>
                    <div class="album-meta-large">
                        <span>${album.year}</span>
                        <span>•</span>
                        <span>${album.tracks} ${translations[currentLanguage].trackCount}</span>
                        <span>•</span>
                        <span>${album.duration}</span>
                    </div>
                    <div class="album-actions">
                        <button class="play-album-btn" onclick="playAlbum()">
                            ▶ ${translations[currentLanguage].listen}
                        </button>
                    </div>
                </div>
            `;

            // Заполняем список треков
            const tracksList = document.getElementById('tracksList');
            tracksList.innerHTML = '';

            const tracks = album.tracksList && album.tracksList.length > 0 
                ? album.tracksList 
                : generateTracks(album.tracks, album.artist, album.title);

            tracks.forEach((track, index) => {
                const trackItem = document.createElement('div');
                trackItem.className = 'track-item-album';
                trackItem.onclick = () => playTrackFromAlbum(track);

                trackItem.innerHTML = `
                    <div class="track-number-album">${index + 1}</div>
                    <img src="${track.image || album.image}" class="track-image-album" alt="${track.title}">
                    <div class="track-info-album">
                        <div class="track-title-album">${track.title}</div>
                        <div class="track-artist-album">${track.artist}</div>
                    </div>
                    <div class="track-duration-album">${track.duration}</div>
                `;

                tracksList.appendChild(trackItem);
            });
        }

        // Генерация треков для альбома
        function generateTracks(count, artist, albumTitle) {
            const tracks = [];
            const trackTitles = [
                'Интро', 'Рассвет', 'День', 'Закат', 'Ночь',
                'Город', 'Дорога', 'Мечты', 'Реальность', 'Воспоминания'
            ];

            for (let i = 0; i < count; i++) {
                const title = trackTitles[i] || `Трек ${i + 1}`;
                const duration = `${Math.floor(Math.random() * 3) + 2}:${Math.floor(Math.random() * 60).toString().padStart(2, '0')}`;

                tracks.push({ 
                    id: `gen-${i}-${Date.now()}`,
                    title, 
                    artist,
                    album: albumTitle,
                    duration,
                    image: testImages[i % testImages.length]
                });
            }

            return tracks;
        }

        // Воспроизведение альбома
        function playAlbum() {
            if (!currentAlbum) return;

            const tracksList = document.getElementById('tracksList');
            const firstTrackItem = tracksList.querySelector('.track-item-album');

            if (firstTrackItem) {
                // Находим первый трек
                const trackIndex = parseInt(firstTrackItem.querySelector('.track-number-album').textContent) - 1;
                const tracks = currentAlbum.tracksList && currentAlbum.tracksList.length > 0 
                    ? currentAlbum.tracksList 
                    : generateTracks(currentAlbum.tracks, currentAlbum.artist, currentAlbum.title);

                if (tracks[trackIndex]) {
                    playTrackFromAlbum(tracks[trackIndex]);
                }
            }

            showNotification(`${translations[currentLanguage].listen}: ${currentAlbum.title}`);
        }

        // Воспроизведение трека из альбома
        function playTrackFromAlbum(track) {
            currentTrack = track;

            updatePlayer({
                title: track.title,
                artist: track.artist,
                album: track.album || currentAlbum.title,
                image: track.image || currentAlbum.image,
                isPlaying: true
            });

            // Обновляем состояние сердечка
            const heartBtn = document.getElementById('playerHeartBtn');
            if (heartBtn) {
                heartBtn.classList.toggle('liked', likedTracks.has(track.id));
            }

            // Добавляем в предпочтения
            addToPreferences(track);

            showNotification(`${translations[currentLanguage].listen}: ${track.title} - ${track.artist}`);
        }

        // Воспроизведение трека из коллекции
        function playTrackFromCollection(track) {
            currentTrack = track;

            updatePlayer({
                title: track.title,
                artist: track.artist,
                album: track.album,
                image: track.image,
                isPlaying: true
            });

            // Обновляем состояние сердечка
            const heartBtn = document.getElementById('playerHeartBtn');
            if (heartBtn) {
                heartBtn.classList.toggle('liked', likedTracks.has(track.id));
            }

            showNotification(`${translations[currentLanguage].listen}: ${track.title} - ${track.artist}`);
        }

        // Смена языка
        function changeLanguage(langCode) {
            currentLanguage = langCode;
            loadLanguages();
            updateInterfaceLanguage();
            loadSubscriptionPlans();

            showNotification(`Язык изменен на: ${languages.find(l => l.code === langCode).name}`);
        }

        // Обновление интерфейса при смене языка
        function updateInterfaceLanguage() {
            const t = translations[currentLanguage];

            // Обновляем поиск
            const searchInput = document.querySelector('.search-input');
            if (searchInput) searchInput.placeholder = t.searchPlaceholder;

            // Обновляем главную страницу
            const soundHeroTitle = document.querySelector('.sound-hero-title');
            const soundHeroSubtitle = document.querySelector('.sound-hero-subtitle');
            const configureBtn = document.querySelector('.hero-action-btn.primary');
            const listenBtn = document.querySelector('.hero-action-btn.secondary');

            if (soundHeroTitle) soundHeroTitle.textContent = t.soundHeroTitle;
            if (soundHeroSubtitle) soundHeroSubtitle.textContent = t.soundHeroSubtitle;
            if (configureBtn) configureBtn.textContent = t.configureSound;
            if (listenBtn) listenBtn.textContent = t.listen;

            // Обновляем подборки музыки
            const sectionTitle = document.querySelector('.section-title');
            const moodCards = document.querySelectorAll('.mood-title');
            const moodSubtitles = document.querySelectorAll('.mood-subtitle');

            if (sectionTitle) sectionTitle.textContent = t.musicCollections;
            if (moodCards[0]) moodCards[0].innerHTML = `<div class="mood-icon"></div>${t.genres}`;
            if (moodCards[1]) moodCards[1].innerHTML = `<div class="mood-icon"></div>${t.activities}`;
            if (moodCards[2]) moodCards[2].innerHTML = `<div class="mood-icon"></div>${t.moods}`;

            if (moodSubtitles[0]) moodSubtitles[0].textContent = t.genresDesc;
            if (moodSubtitles[1]) moodSubtitles[1].textContent = t.activitiesDesc;
            if (moodSubtitles[2]) moodSubtitles[2].textContent = t.moodsDesc;

            // Обновляем табы
            const forYouTab = document.querySelector('.tab[onclick="switchTab(\'for-you\')"]');
            const trendsTab = document.querySelector('.tab[onclick="switchTab(\'trends\')"]');
            const newTab = document.querySelector('.tab[onclick="switchTab(\'new\')"]');

            if (forYouTab) forYouTab.textContent = t.forYou;
            if (trendsTab) trendsTab.textContent = t.trends;
            if (newTab) newTab.textContent = t.new;

            // Обновляем "Для вас" заголовок
            const forYouTitle = document.querySelector('.for-you-title');
            const forYouSubtitle = document.querySelector('.for-you-subtitle');

            if (forYouTitle) forYouTitle.textContent = t.basedOnPreferences;
            if (forYouSubtitle) forYouSubtitle.textContent = t.tracksYouWillLike;

            // Обновляем кнопку "Назад"
            const backButtons = document.querySelectorAll('.back-btn');
            backButtons.forEach(btn => {
                btn.textContent = t.back;
            });

            // Обновляем заголовки настроек
            const settingsTitles = document.querySelectorAll('.settings-title');
            settingsTitles.forEach(title => {
                if (title.classList.contains('language')) title.textContent = t.language;
                if (title.classList.contains('support')) title.textContent = t.support;
            });

            // Обновляем техподдержку
            const supportTitles = document.querySelectorAll('.support-title');
            const supportDescriptions = document.querySelectorAll('.support-description');

            if (supportTitles[0]) supportTitles[0].textContent = t.onlineChat;
            if (supportDescriptions[0]) supportDescriptions[0].textContent = t.onlineChatDesc;
            if (supportTitles[1]) supportTitles[1].textContent = t.emailSupport;
            if (supportDescriptions[1]) supportDescriptions[1].textContent = t.emailSupportDesc;
            if (supportTitles[2]) supportTitles[2].textContent = t.faqHelp;
            if (supportDescriptions[2]) supportDescriptions[2].textContent = t.faqHelpDesc;

            // Обновляем подписки заголовок
            const subscriptionTitle = document.getElementById('subscriptionTitleText');
            const subscriptionSubtitle = document.getElementById('subscriptionSubtitleText');
            const promocodeDescription = document.getElementById('promocodeDescriptionText');

            if (subscriptionTitle) subscriptionTitle.textContent = t.subscriptionTitle;
            if (subscriptionSubtitle) subscriptionSubtitle.textContent = t.subscriptionSubtitle;
            if (promocodeDescription) promocodeDescription.textContent = t.promocodeDesc;

            // Обновляем коллекцию
            const emptyTitle = document.querySelector('.empty-title');
            const emptySubtitle = document.querySelector('.empty-subtitle');

            if (emptyTitle) emptyTitle.textContent = t.emptyCollection;
            if (emptySubtitle) emptySubtitle.textContent = t.emptyCollectionDesc;

            // Обновляем плеер
            const playerTitle = document.querySelector('.player-title');
            const playerArtist = document.querySelector('.player-artist');

            if (playerTitle && playerTitle.textContent === 'Выберите трек') playerTitle.textContent = t.selectTrack;
            if (playerArtist && playerArtist.textContent === 'Нажмите на трек или альбом') playerArtist.textContent = t.clickTrack;

            // Обновляем навигацию
            const navLabels = document.querySelectorAll('.nav-label');
            if (navLabels[0]) navLabels[0].textContent = t.music;
            if (navLabels[1]) navLabels[1].textContent = t.collection;

            // Обновляем треки в "Для вас"
            loadTracksColumns();

            // Обновляем статистику в коллекциях
            const trackCounts = document.querySelectorAll('.collection-stats span:nth-child(1)');
            const playsCounts = document.querySelectorAll('.collection-stats span:nth-child(2)');

            trackCounts.forEach(el => {
                const text = el.innerHTML;
                el.innerHTML = text.replace(/треков|tracks/, t.trackCount);
            });

            playsCounts.forEach(el => {
                const text = el.innerHTML;
                el.innerHTML = text.replace(/прослушиваний|plays/, t.plays);
            });
        }

        // Подписка на план
        function subscribeToPlan(planId, price) {
            const plans = subscriptionPlans[currentLanguage];
            const plan = plans.find(p => p.id === planId);
            if (plan) {
                const periodText = plan.period;
                showNotification(`Вы выбрали подписку: ${periodText} за ${price} TON`);
            }
        }

        // Применение промокода
        function applyPromocode() {
            const promocodeInput = document.getElementById('promocodeInput');
            const promocode = promocodeInput.value.trim();

            if (!promocode) {
                showNotification('Введите промокод');
                return;
            }

            // Простая проверка тестового промокода
            if (promocode.toUpperCase() === 'MYRHYTHM2024' || promocode.toUpperCase() === 'TEST') {
                showNotification('Промокод успешно применен! Скидка 10% активирована.');
                promocodeInput.value = '';
            } else {
                showNotification('Недействительный промокод');
            }
        }

        // Техподдержка
        function contactSupport(type) {
            if (type === 'chat') {
                showNotification('Открывается онлайн-чат с поддержкой...');
            } else if (type === 'email') {
                showNotification('Открывается почтовый клиент...');
            }
        }

        function openFAQ() {
            showNotification('Открывается раздел FAQ...');
        }

        // Добавление в предпочтения
        function addToPreferences(track) {
            if (!userPreferences.some(pref => pref.id === track.id)) {
                userPreferences.push({
                    id: track.id,
                    title: track.title,
                    artist: track.artist,
                    genre: track.genre,
                    mood: track.mood,
                    timestamp: new Date().getTime()
                });

                if (userPreferences.length > 10) {
                    userPreferences.shift();
                }
            }
        }

        // Назад к основному контенту
        function goBack() {
            if (document.getElementById('albumPage').style.display === 'block') {
                document.getElementById('albumPage').style.display = 'none';
                document.getElementById('mainPage').style.display = 'block';
                currentAlbum = null;
            } else {
                switchPage('music');
            }
        }

        // Обновление плеера
        function updatePlayer(trackData) {
            const playerTitle = document.querySelector('.player-title');
            const playerArtist = document.querySelector('.player-artist');
            const playerCover = document.querySelector('.player-cover');
            const playBtn = document.getElementById('playerPlayBtn');
            const heartBtn = document.getElementById('playerHeartBtn');

            if (playerTitle) playerTitle.textContent = trackData.title;
            if (playerArtist) playerArtist.textContent = `${trackData.artist} • ${trackData.album}`;

            if (playerCover && trackData.image) {
                playerCover.style.backgroundImage = `url('${trackData.image}')`;
                playerCover.style.backgroundSize = 'cover';
            }

            if (trackData.isPlaying && playBtn) {
                playBtn.classList.add('playing');
                isPlaying = true;
            } else if (playBtn) {
                playBtn.classList.remove('playing');
                isPlaying = false;
            }

            if (heartBtn && currentTrack) {
                heartBtn.classList.toggle('liked', likedTracks.has(currentTrack.id));
            }
        }

        // Настройка звука
        function configureSound() {
            soundConfigured = true;
            userPreferences = [
                { id: 'fy-1', title: 'Рассвет', artist: 'Miyagi & Andy Panda', genre: 'Хип-хоп', mood: 'Спокойное', timestamp: Date.now() },
                { id: 'fy-3', title: 'Дорога', artist: 'Кис-кис', genre: 'Рок', mood: 'Путешествие', timestamp: Date.now() }
            ];

            showNotification('Настройка "Моего ритма" завершена! Система изучила ваши предпочтения.');
        }

        // Воспроизведение звука
        function playSound() {
            if (!soundConfigured) {
                alert('Сначала настройте "Мой ритм" для персонализированных рекомендаций!');
                return;
            }

            const randomTrack = forYouTracks[Math.floor(Math.random() * forYouTracks.length)];
            openTrack(randomTrack, 'for-you');

            showNotification('Запущен "Мой ритм" - персонализированная подборка на основе ваших предпочтений');
        }

        // Настройка обработчиков событий
        function setupEventListeners() {
            // Кнопка плеера
            const playBtn = document.getElementById('playerPlayBtn');
            if (playBtn) {
                playBtn.addEventListener('click', function() {
                    isPlaying = !isPlaying;
                    this.classList.toggle('playing');

                    if (currentTrack) {
                        if (isPlaying) {
                            showNotification(`${translations[currentLanguage].listen}: ${currentTrack.title}`);
                        } else {
                            showNotification('Воспроизведение остановлено');
                        }
                    } else {
                        if (isPlaying) {
                            showNotification('Воспроизведение начато');
                        } else {
                            showNotification('Воспроизведение остановлено');
                        }
                    }
                });
            }

            // Кнопка сердечка
            const heartBtn = document.getElementById('playerHeartBtn');
            if (heartBtn) {
                heartBtn.addEventListener('click', function() {
                    if (!currentTrack) return;

                    if (likedTracks.has(currentTrack.id)) {
                        likedTracks.delete(currentTrack.id);
                        this.classList.remove('liked');
                        showNotification(`Трек "${currentTrack.title}" удален из коллекции`);
                    } else {
                        likedTracks.add(currentTrack.id);
                        this.classList.add('liked');
                        showNotification(`Трек "${currentTrack.title}" добавлен в коллекцию`);
                    }

                    if (currentPage === 'collection') {
                        updateCollectionPage();
                    }
                });
            }

            // Промокод ввод по Enter
            const promocodeInput = document.getElementById('promocodeInput');
            if (promocodeInput) {
                promocodeInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        applyPromocode();
                    }
                });
            }
        }

        // Вспомогательные функции
        function openCategory(categoryId) {
            console.log('Открыта категория:', categoryId);
        }

        function showUserMenu() {
            console.log('Открыто меню пользователя');
            alert('Меню пользователя: Профиль, Настройки, Выйти');
        }

        function showNotification(message) {
            const oldNotification = document.querySelector('.notification');
            if (oldNotification) {
                oldNotification.remove();
            }

            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 3000);
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyRhythm</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        :root {
            --primary: #FF2E2E;
            --primary-dark: #CC0000;
            --primary-light: #FF6B6B;
            --accent: #00C853;
            --accent-dark: #00A844;
            --purple: #9C27B0;
            --blue: #2196F3;
            --cyan: #00BCD4;
            --orange: #FF9800;
            --pink: #E91E63;
            --indigo: #3F51B5;

            --bg-dark: #000000;
            --bg-card: #1A1A1A;
            --bg-surface: #242424;
            --bg-hover: #2C2C2C;

            --border: #333333;
            --border-light: #404040;

            --text-primary: #FFFFFF;
            --text-secondary: #B3B3B3;
            --text-tertiary: #666666;

            --gradient-primary: linear-gradient(135deg, #FF2E2E 0%, #FF6B00 100%);
            --gradient-accent: linear-gradient(135deg, #00C853 0%, #00D4AA 100%);
            --gradient-purple: linear-gradient(135deg, #9C27B0 0%, #673AB7 100%);
            --gradient-blue: linear-gradient(135deg, #2196F3 0%, #03A9F4 100%);
            --gradient-cyan: linear-gradient(135deg, #00BCD4 0%, #0097A7 100%);
            --gradient-orange: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
            --gradient-pink: linear-gradient(135deg, #E91E63 0%, #C2185B 100%);
            --gradient-indigo: linear-gradient(135deg, #3F51B5 0%, #303F9F 100%);

            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
            --shadow-xl: 0 16px 64px rgba(0, 0, 0, 0.6);

            --glow-primary: 0 0 20px rgba(255, 46, 46, 0.3);
            --glow-accent: 0 0 20px rgba(0, 200, 83, 0.3);
            --glow-cyan: 0 0 20px rgba(0, 188, 212, 0.3);
            --glow-orange: 0 0 20px rgba(255, 152, 0, 0.3);
        }

        body {
            background: #0f0c29;
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* ЧЕРНЫЙ ФОН ДЛЯ НАСТРОЕК */
        body.settings-mode {
            background: #000000 !important;
        }

        body.settings-mode .aurora-rhythm-bg {
            opacity: 0;
        }

        /* Aurora Rhythm Background - растянутый на весь экран */
        .aurora-rhythm-bg {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            overflow: hidden;
            background: 
                radial-gradient(circle at 20% 20%, #0098EA 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, #9333ea 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, #00C853 0%, transparent 50%),
                linear-gradient(135deg, #0f0c29 0%, #0a081f 100%);
            opacity: 0.8;
            transition: opacity 0.5s ease;
        }

        /* Анимированные пятна Aurora */
        .aurora-spot {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.4;
            animation: auroraFloat 20s infinite alternate ease-in-out;
        }

        .aurora-spot-1 {
            width: 400px;
            height: 400px;
            background: #0098EA;
            top: -100px;
            left: -100px;
            animation-delay: 0s;
        }

        .aurora-spot-2 {
            width: 350px;
            height: 350px;
            background: #9333ea;
            bottom: -80px;
            right: -80px;
            animation-delay: -5s;
            animation-duration: 25s;
        }

        .aurora-spot-3 {
            width: 300px;
            height: 300px;
            background: #00C853;
            top: 50%;
            left: 70%;
            animation-delay: -10s;
            animation-duration: 30s;
        }

        .aurora-spot-4 {
            width: 250px;
            height: 250px;
            background: #FF2E2E;
            bottom: 30%;
            left: 10%;
            animation-delay: -15s;
            animation-duration: 22s;
        }

        @keyframes auroraFloat {
            0%, 100% {
                transform: translate(0, 0) scale(1) rotate(0deg);
            }
            25% {
                transform: translate(50px, 30px) scale(1.1) rotate(10deg);
            }
            50% {
                transform: translate(-30px, 50px) scale(0.9) rotate(-15deg);
            }
            75% {
                transform: translate(-50px, -30px) scale(1.05) rotate(20deg);
            }
        }

        /* Парящие частицы */
        .floating-particle {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: floatParticle 15s infinite linear;
        }

        @keyframes floatParticle {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.3;
            }
            90% {
                opacity: 0.3;
            }
            100% {
                transform: translateY(-100px) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Header - ИСПРАВЛЕННЫЙ БЕЗ ЧЕРНОГО ФОНА */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 1000;
            border-bottom: none;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .settings-btn {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.25);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.35);
            transform: rotate(30deg);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .settings-btn::before {
            content: '';
            width: 20px;
            height: 20px;
            background: var(--text-primary);
            mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z'/%3E%3C/svg%3E") center/contain no-repeat;
        }

        .search-bar {
            flex: 1;
            max-width: 500px;
            position: relative;
            margin: 0 20px;
        }

        .search-input {
            width: 100%;
            padding: 12px 20px 12px 48px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 46, 46, 0.15);
            box-shadow: 0 0 0 3px rgba(255, 46, 46, 0.2), 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            background: var(--text-secondary);
            mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z'/%3E%3C/svg%3E") center/contain no-repeat;
            pointer-events: none;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.2s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
        }

        .user-avatar:hover {
            transform: scale(1.05);
            border-color: var(--primary-light);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
        }

        .user-avatar-placeholder {
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
        }

        /* Main Content */
        .main-content {
            padding-top: 60px;
            padding-bottom: 140px;
            height: 100vh;
            overflow-y: auto;
            position: relative;
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
        }

        /* БОЛЬШОЙ КОНТЕЙНЕР ДЛЯ ГЛАВНОЙ СТРАНИЦЫ */
        .main-container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
        }

        /* ИСПРАВЛЕННАЯ ГЛАВНАЯ СЕКЦИЯ */
        .sound-hero-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 25px 20px 0;
            position: relative;
            text-align: center;
            margin-bottom: 0;
            z-index: 2;
        }

        .sound-hero-title {
            font-size: 34px;
            font-weight: 900;
            background: linear-gradient(45deg, 
                var(--primary) 0%,
                var(--purple) 50%,
                var(--blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 1px;
            margin-bottom: 12px;
            position: relative;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .sound-hero-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: var(--gradient-primary);
            border-radius: 2px;
            box-shadow: 0 0 10px rgba(255, 46, 46, 0.5);
        }

        .sound-hero-subtitle {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
            max-width: 400px;
            line-height: 1.4;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }

        /* АНИМАЦИЯ ПОЛОС */
        .sound-visualizer {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 6px;
            height: 50px;
            margin: 15px 0 25px;
            position: relative;
        }

        .visualizer-bar {
            width: 8px;
            background: var(--gradient-primary);
            border-radius: 4px 4px 0 0;
            animation: visualizerMove 1.5s ease-in-out infinite;
            box-shadow: 0 0 10px rgba(255, 46, 46, 0.3);
        }

        .visualizer-bar:nth-child(2n) {
            background: var(--gradient-purple);
            animation-delay: 0.2s;
            box-shadow: 0 0 10px rgba(156, 39, 176, 0.3);
        }

        .visualizer-bar:nth-child(3n) {
            background: var(--gradient-blue);
            animation-delay: 0.4s;
            box-shadow: 0 0 10px rgba(33, 150, 243, 0.3);
        }

        .visualizer-bar:nth-child(5n) {
            background: var(--gradient-accent);
            animation-delay: 0.6s;
            box-shadow: 0 0 10px rgba(0, 200, 83, 0.3);
        }

        @keyframes visualizerMove {
            0%, 100% {
                height: 10px;
            }
            50% {
                height: 40px;
            }
        }

        /* КНОПКИ */
        .sound-hero-actions {
            display: flex;
            gap: 12px;
            margin: 0 0 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .hero-action-btn {
            position: relative;
            padding: 12px 28px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 160px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            backdrop-filter: blur(10px);
        }

        .hero-action-btn.primary {
            background: linear-gradient(135deg, rgba(255, 46, 46, 0.9), rgba(255, 107, 0, 0.9));
            color: white;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .hero-action-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 2px solid rgba(255, 46, 46, 0.5);
            backdrop-filter: blur(20px);
        }

        .hero-action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
        }

        .hero-action-btn.primary:hover {
            background: linear-gradient(135deg, rgba(255, 46, 46, 1), rgba(255, 107, 0, 1));
            box-shadow: 0 0 20px rgba(255, 46, 46, 0.4);
        }

        .hero-action-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 46, 46, 0.8);
            box-shadow: 0 0 15px rgba(255, 46, 46, 0.3);
        }

        /* ИСПРАВЛЕННЫЙ СЛАЙДЕР */
        .image-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto 25px;
            border-radius: 20px;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
            height: auto;
            background: rgba(26, 26, 26, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }

        .main-image {
            width: 100%;
            height: auto;
            object-fit: contain;
            transition: transform 0.5s ease;
            display: block;
        }

        .image-container:hover .main-image {
            transform: scale(1.05);
        }

        .image-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            padding: 15px;
            color: white;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .image-container:hover .image-overlay {
            opacity: 1;
        }

        .image-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
            color: white;
        }

        .image-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.9);
        }

        /* ИСПРАВЛЕННЫЙ КОНТЕЙНЕР С КОНТЕНТОМ */
        .content-container {
            background: linear-gradient(180deg, 
                rgba(15, 12, 41, 0.95) 0%,
                rgba(26, 26, 26, 0.98) 100%);
            border-radius: 24px 24px 0 0;
            padding: 30px 20px 30px;
            position: relative;
            z-index: 1;
            min-height: calc(100vh - 220px);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: none;
            box-shadow: 0 -20px 50px rgba(0, 0, 0, 0.5);
            margin: 0 0px;
            width: calc(100% + 40px);
            margin-left: -20px;
            margin-top: -145px;
            padding-top: 100px;
        }

        /* СДВИГАЕМ ПОДБОРКИ МУЗЫКИ ВНИЗ ОТДЕЛЬНО */
        .moods-section {
            margin: 40px 0 20px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-primary);
            position: relative;
            display: inline-block;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 0;
            width: 50px;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 2px;
            box-shadow: 0 0 10px rgba(255, 46, 46, 0.5);
        }

        .moods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .mood-card {
            background: rgba(26, 26, 26, 0.7);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .mood-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-primary);
        }

        .mood-card:hover {
            transform: translateY(-4px);
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
        }

        .mood-title {
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mood-icon {
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .mood-subtitle {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.4;
        }

        /* Табы контента */
        .content-tabs {
            display: flex;
            gap: 8px;
            margin: 30px 0;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab {
            background: none;
            border: none;
            padding: 10px 20px;
            font-size: 15px;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
            border-radius: 8px;
            font-weight: 500;
        }

        .tab:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        .tab.active {
            color: var(--text-primary);
            font-weight: 600;
            background: rgba(255, 255, 255, 0.15);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }

        /* Контейнер для контента табов */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* СТРАНИЦА НАСТРОЕК */
        .settings-page {
            display: none;
            animation: fadeIn 0.3s ease;
            padding: 20px 0 100px;
            background: #000000;
            border-radius: 24px;
            margin: 20px 0;
            position: relative;
            z-index: 2;
        }

        .settings-page.active {
            display: block;
        }

        /* --- ИСПРАВЛЕННЫЙ РАЗДЕЛ НАСТРОЕК ЗВУКА --- */
        .sound-settings-page {
            display: none;
            animation: fadeIn 0.3s ease;
            background: #000000;
            position: relative;
            z-index: 2;
            min-height: 100vh;
            width: 100%;
            overflow-x: hidden;
            max-width: 100%;
            margin: 0;
            padding: 20px 0 100px;
        }

        .sound-settings-page.active {
            display: block;
        }

        .sound-settings-page h1 {
            font-size: 26px;
            font-weight: 800;
            margin: 0 16px 35px;
            text-align: left;
            letter-spacing: -1px;
            color: white;
        }

        /* --- ЗАНЯТИЕ (исправленные границы) --- */
        .scroll-row { 
            display: flex; 
            overflow-x: auto; 
            gap: 8px; 
            scrollbar-width: none; 
            margin: 0 16px 40px;
            padding: 0 0 10px;
        }
        .scroll-row::-webkit-scrollbar { display: none; }
        .pill { 
            background: #121212; 
            border: 1px solid #222; 
            padding: 12px 22px; 
            border-radius: 25px; 
            font-size: 15px; 
            white-space: nowrap; 
            transition: 0.2s; 
            color: #fff; 
            cursor: pointer;
            flex-shrink: 0;
        }
        .pill.active { 
            background: #fff; 
            color: #000; 
            font-weight: 600; 
            border-color: #fff; 
        }

        /* --- ИСТОЧНИК (убрал отступы) --- */
        .label {
            font-size: 12px;
            font-weight: 700;
            color: #666;
            margin: 0 16px 15px;
            text-align: left; 
            display: block;
            text-transform: lowercase;
            letter-spacing: 0.8px;
        }

        .grid-3 { 
            display: grid; 
            grid-template-columns: 1fr 1fr 1fr; 
            gap: 12px; 
            margin: 0 16px 40px;
            padding: 0;
        }
        .source-card { 
            background: #121212; 
            border: 1px solid #222; 
            border-radius: 24px; 
            aspect-ratio: 1/1.1; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            gap: 12px; 
            transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            cursor: pointer; 
            position: relative; 
            margin: 0;
        }
        .source-card.active { 
            border-color: #444; 
            background: #1a1a1a; 
            transform: translateY(-5px); 
            box-shadow: 0 12px 25px rgba(255,255,255,0.05); 
        }
        .source-card span { 
            font-size: 11px; 
            font-weight: 700; 
            color: #666; 
        }
        .source-card.active span { 
            color: #fff; 
        }

        .icon-box { 
            width: 48px; 
            height: 48px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }

        /* --- ИСПРАВЛЕННЫЕ КРУЖКИ НАСТРОЕНИЯ --- */
        .mood-row { 
            display: flex; 
            justify-content: space-between; 
            margin: 0 16px 40px;
            padding: 0 5px;
        }
        .mood-item { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 10px; 
            cursor: pointer; 
        }
        .sphere { 
            width: 58px; 
            height: 58px; 
            border-radius: 50%; 
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            position: relative; 
            border: 2px solid transparent; 
            background-size: cover;
        }
        .mood-item.active .sphere { 
            transform: scale(1.15); 
            box-shadow: 0 0 30px rgba(255,255,255,0.1); 
            border-color: #fff; 
        }
        .mood-item span { 
            font-size: 12px; 
            color: #666; 
            transition: color 0.3s ease;
        }
        .mood-item.active span { 
            color: #fff; 
        }

        /* Улучшенные градиенты для кружков настроения */
        .s-red { 
            background: radial-gradient(circle at 30% 30%, #ff4b2b, #ff416c, #800000);
            background-size: 200% 200%;
            animation: gradientPulse 4s ease infinite;
        }

        .s-green { 
            background: radial-gradient(circle at 30% 30%, #00ff88, #00d4aa, #004d26);
            background-size: 200% 200%;
            animation: gradientPulse 4s ease infinite 0.5s;
        }

        .s-blue { 
            background: radial-gradient(circle at 30% 30%, #00d2ff, #0099ff, #003366);
            background-size: 200% 200%;
            animation: gradientPulse 4s ease infinite 1s;
        }

        .s-gold { 
            background: radial-gradient(circle at 30% 30%, #ffcc00, #ff9500, #665200);
            background-size: 200% 200%;
            animation: gradientPulse 4s ease infinite 1.5s;
        }

        @keyframes gradientPulse {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }

        /* --- АВТОРЫ (исправленные границы) --- */
        .authors-list { 
            display: flex; 
            align-items: center; 
            gap: 15px; 
            overflow-x: auto; 
            scrollbar-width: none; 
            margin: 0 16px 40px;
            padding: 0 0 15px;
        }
        .authors-list::-webkit-scrollbar { display: none; }
        .author-circle { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 8px; 
            flex-shrink: 0; 
            animation: fadeIn 0.4s ease; 
        }
        .author-img { 
            width: 62px; 
            height: 62px; 
            border-radius: 50%; 
            background: #222; 
            overflow: hidden; 
            border: 1px solid #333; 
        }
        .author-img img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
        }
        .author-circle span { 
            font-size: 11px; 
            color: #666; 
        }
        .btn-trigger { 
            width: 58px; 
            height: 58px; 
            border-radius: 50%; 
            border: 1px solid #333; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            background: #111; 
            flex-shrink: 0; 
            cursor: pointer; 
        }

        /* --- ШТОРКА (исправленные границы) --- */
        .overlay { 
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.8); 
            z-index: 1000; 
            opacity: 0; 
            pointer-events: none; 
            transition: 0.3s; 
            backdrop-filter: blur(10px); 
        }
        .drawer { 
            position: fixed; 
            bottom: 0; 
            left: 0; 
            right: 0; 
            height: 95vh; 
            background: #0a0a0a; 
            border-radius: 30px 30px 0 0; 
            z-index: 1001; 
            transform: translateY(100%); 
            transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1); 
            padding: 25px; 
            box-sizing: border-box; 
            max-width: 100%;
        }
        .overlay.active { 
            opacity: 1; 
            pointer-events: auto; 
        }
        .drawer.active { 
            transform: translateY(0); 
        }
        .search-box { 
            width: 100%; 
            background: #1a1a1a; 
            border: 1px solid #333; 
            border-radius: 15px; 
            padding: 18px; 
            color: #fff; 
            font-size: 17px; 
            margin-bottom: 25px; 
            outline: none; 
            box-sizing: border-box; 
        }
        .drawer-grid { 
            display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            gap: 15px; 
            overflow-y: auto; 
            max-height: 75vh; 
            padding: 0 0 20px;
        }

        /* --- ФУТЕР (исправленные границы) --- */
        .sound-settings-footer { 
            text-align: center; 
            padding: 30px 16px; 
        }
        .reset-sound-button { 
            background: none; 
            border: none; 
            color: #666; 
            font-size: 14px; 
            font-weight: 600; 
            letter-spacing: 1px; 
            cursor: pointer; 
            width: 100%;
        }

        @keyframes fadeIn { 
            from { 
                opacity: 0; 
                transform: scale(0.9); 
            } 
            to { 
                opacity: 1; 
                transform: scale(1); 
            } 
        }

        /* Остальные стили остаются прежними... */
        .settings-section {
            background: rgba(20, 20, 20, 0.95);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            padding: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .settings-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .settings-title::before {
            content: '';
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .settings-title.language::before {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z'/%3E%3C/svg%3E") center/14px no-repeat var(--primary);
        }

        .settings-title.support::before {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z'/%3E%3C/svg%3E") center/14px no-repeat var(--primary);
        }

        .settings-title.subscription::before {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5l-3-4zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm13.5-9l1.96 2.5H17V9.5h2.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z'/%3E%3C/svg%3E") center/14px no-repeat var(--primary);
        }

        /* Языки */
        .languages-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 12px;
        }

        .language-option {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            backdrop-filter: blur(5px);
        }

        .language-option:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 46, 46, 0.5);
            transform: translateY(-2px);
        }

        .language-option.active {
            border-color: var(--primary);
            background: rgba(255, 46, 46, 0.2);
        }

        .language-flag {
            width: 35px;
            height: 25px;
            border-radius: 3px;
            object-fit: cover;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .language-info {
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }

        .language-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .language-natives {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.7);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Техподдержка */
        .support-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .support-option {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 16px;
            backdrop-filter: blur(5px);
        }

        .support-option:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 46, 46, 0.5);
            transform: translateX(5px);
        }

        .support-icon {
            width: 45px;
            height: 45px;
            border-radius: 22px;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .support-icon::before {
            content: '';
            width: 20px;
            height: 20px;
            background: white;
            mask-position: center;
            mask-repeat: no-repeat;
            mask-size: contain;
        }

        .support-option:nth-child(1) .support-icon::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 12h-2v-2h2v2zm0-4h-2V6h2v4z'/%3E%3C/svg%3E");
        }

        .support-option:nth-child(2) .support-icon::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z'/%3E%3C/svg%3E");
        }

        .support-option:nth-child(3) .support-icon::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z'/%3E%3C/svg%3E");
        }

        .support-info {
            flex: 1;
            min-width: 0;
        }

        .support-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .support-description {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.4;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* КРАСИВЫЙ ЗАГОЛОВОК ПОДПИСКИ */
        .subscription-header {
            text-align: center;
            margin-bottom: 25px;
            padding: 20px;
            background: linear-gradient(135deg, 
                rgba(255, 46, 46, 0.2),
                rgba(156, 39, 176, 0.2));
            border-radius: 16px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .subscription-title {
            font-size: 32px;
            font-weight: 900;
            background: linear-gradient(45deg, 
                var(--primary) 20%,
                var(--purple) 50%,
                var(--blue) 80%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
            word-wrap: break-word;
            max-width: 100%;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .subscription-subtitle {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
            max-width: 400px;
            margin: 10px auto 0;
            line-height: 1.4;
        }

        /* ОБНОВЛЕННЫЕ ПОДПИСКИ */
        .subscription-plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .plan-card {
            background: linear-gradient(145deg, rgba(26, 26, 26, 0.8), rgba(15, 12, 41, 0.6));
            border-radius: 16px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            padding: 25px 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 100%;
            backdrop-filter: blur(10px);
        }

        .plan-card:hover {
            transform: translateY(-8px);
            border-color: var(--primary);
            box-shadow: 
                0 15px 30px rgba(0, 0, 0, 0.4),
                0 0 80px rgba(255, 46, 46, 0.2);
        }

        .plan-card.popular {
            border-color: var(--primary);
            background: linear-gradient(145deg, 
                rgba(255, 46, 46, 0.25),
                rgba(26, 26, 26, 0.8)
            );
        }

        .plan-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 5;
        }

        .plan-period {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .plan-price-container {
            display: flex;
            align-items: baseline;
            justify-content: center;
            gap: 6px;
            margin-bottom: 5px;
            position: relative;
            z-index: 5;
        }

        .plan-price {
            font-size: 48px;
            font-weight: 900;
            line-height: 1;
            background: linear-gradient(45deg, var(--text-primary), var(--text-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            display: inline-block;
        }

        .plan-card.popular .plan-price {
            background: linear-gradient(45deg, var(--primary), var(--purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .plan-currency {
            font-size: 16px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.9);
            margin-left: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
            position: relative;
            z-index: 5;
        }

        /* ИКОНКА TON */
        .ton-icon {
            width: 20px;
            height: 20px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .ton-icon svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 0 4px rgba(0, 152, 234, 0.5));
        }

        .plan-savings {
            background: linear-gradient(45deg, var(--primary), var(--purple));
            color: white;
            padding: 6px 14px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 700;
            display: inline-block;
            margin-top: 8px;
            box-shadow: var(--shadow-sm);
            letter-spacing: 0.5px;
            position: relative;
            z-index: 5;
        }

        /* ИСПРАВЛЕННЫЕ КРУЖКИ С ГАЛОЧКАМИ */
        .plan-features {
            flex: 1;
            margin-bottom: 25px;
            position: relative;
            z-index: 5;
        }

        .plan-feature {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
            position: relative;
            padding-left: 0;
        }

        .plan-feature::before {
            content: '';
            width: 18px;
            height: 18px;
            background: linear-gradient(45deg, var(--accent), var(--cyan));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            position: relative;
            box-shadow: 0 3px 6px rgba(0, 200, 83, 0.3);
            margin-top: 1px;
        }

        .plan-feature::after {
            content: '✓';
            position: absolute;
            left: 4px;
            color: white;
            font-size: 10px;
            font-weight: bold;
            top: 5px;
        }

        .plan-card.popular .plan-feature::before {
            background: linear-gradient(45deg, var(--primary), var(--purple));
            box-shadow: 0 3px 6px rgba(255, 46, 46, 0.3);
        }

        .plan-button {
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 800;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            width: 100%;
            position: relative;
            overflow: hidden;
            z-index: 5;
        }

        .plan-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent);
            transition: left 0.5s ease;
        }

        .plan-button:hover::before {
            left: 100%;
        }

        .plan-card .plan-button {
            background: linear-gradient(135deg, var(--primary), var(--purple));
            color: white;
            box-shadow: 
                0 6px 20px rgba(255, 46, 46, 0.3);
        }

        .plan-card.popular .plan-button {
            background: linear-gradient(135deg, var(--primary), var(--purple));
            color: white;
            box-shadow: 
                0 8px 25px rgba(255, 46, 46, 0.4);
        }

        .plan-button:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 12px 30px rgba(255, 46, 46, 0.5);
        }

        /* Контейнер для промокода */
        .promocode-container {
            margin-top: 30px;
            padding: 20px;
            background: rgba(26, 26, 26, 0.7);
            border-radius: 14px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .promocode-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .promocode-title::before {
            content: '';
            width: 20px;
            height: 20px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23FF9800'%3E%3Cpath d='M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z'/%3E%3C/svg%3E") center/contain no-repeat;
        }

        .promocode-input-container {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }

        .promocode-input {
            flex: 1;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.3s ease;
            min-width: 0;
            backdrop-filter: blur(5px);
        }

        .promocode-input:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 46, 46, 0.1);
            box-shadow: 0 0 0 3px rgba(255, 46, 46, 0.2);
        }

        .promocode-btn {
            padding: 12px 20px;
            background: var(--gradient-accent);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .promocode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 200, 83, 0.3);
        }

        .promocode-description {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.4;
        }

        /* СТРАНИЦА КОЛЛЕКЦИИ */
        .collection-page {
            display: none;
            animation: fadeIn 0.3s ease;
            padding: 20px 0 100px;
        }

        .collection-page.active {
            display: block;
        }

        .empty-collection {
            text-align: center;
            padding: 50px 20px;
            background: rgba(26, 26, 26, 0.7);
            border-radius: 14px;
            border: 2px dashed rgba(255, 255, 255, 0.2);
            margin-bottom: 25px;
            backdrop-filter: blur(10px);
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .empty-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .empty-subtitle {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            max-width: 350px;
            margin: 0 auto 15px;
            line-height: 1.4;
        }

        .collection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 25px;
        }

        .collection-track-item {
            background: rgba(26, 26, 26, 0.7);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            padding: 12px;
            gap: 12px;
            cursor: pointer;
            backdrop-filter: blur(5px);
        }

        .collection-track-item:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
            background: rgba(255, 255, 255, 0.1);
        }

        .collection-track-image {
            width: 50px;
            height: 50px;
            border-radius: 6px;
            object-fit: cover;
            flex-shrink: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.2));
        }

        .collection-track-info {
            flex: 1;
            min-width: 0;
        }

        .collection-track-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .collection-track-artist {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .collection-track-meta {
            display: flex;
            gap: 12px;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
        }

        /* РАЗДЕЛ "ДЛЯ ВАС" - УЛУЧШЕННАЯ ПРОКРУТКА */
        .for-you-section {
            margin-bottom: 30px;
            position: relative;
        }

        .for-you-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .for-you-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .for-you-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 4px;
        }

        .scroll-buttons {
            display: flex;
            gap: 8px;
        }

        .scroll-btn {
            width: 35px;
            height: 35px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .scroll-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .scroll-btn::before {
            content: '';
            width: 16px;
            height: 16px;
            background: var(--text-primary);
            mask-position: center;
            mask-repeat: no-repeat;
            mask-size: contain;
        }

        .scroll-btn.prev::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z'/%3E%3C/svg%3E");
        }

        .scroll-btn.next::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z'/%3E%3C/svg%3E");
        }

        /* УЛУЧШЕННЫЙ КОНТЕЙНЕР ДЛЯ КОЛОНОК С ПЛАВНОЙ ПРОКРУТКОЙ */
        .tracks-columns-container {
            display: flex;
            gap: 20px;
            width: 100%;
            overflow-x: auto;
            padding: 10px 0 30px;
            scroll-behavior: smooth;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
            scroll-snap-type: x mandatory;
            cursor: grab;
            user-select: none;
        }

        .tracks-columns-container::-webkit-scrollbar {
            display: none;
        }

        .tracks-column {
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-width: 350px;
            flex-shrink: 0;
            scroll-snap-align: start;
        }

        /* ИНДИКАТОРЫ ПРОКРУТКИ - ТОЧКИ */
        .scroll-indicators {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 15px;
            height: 20px;
        }

        .scroll-indicator-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .scroll-indicator-dot.active {
            width: 24px;
            height: 6px;
            border-radius: 3px;
            background: var(--gradient-primary);
        }

        .scroll-indicator-dot:hover {
            background: var(--primary-light);
            transform: scale(1.2);
        }

        .track-card-for-you {
            background: rgba(26, 26, 26, 0.7);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            height: 90px;
            display: flex;
            align-items: center;
            padding: 15px;
            gap: 15px;
            backdrop-filter: blur(5px);
        }

        .track-card-for-you:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4), 0 0 20px rgba(255, 46, 46, 0.3);
        }

        .track-image-for-you {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            object-fit: cover;
            flex-shrink: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.2));
        }

        .track-info-for-you {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            height: 100%;
        }

        .track-title-for-you {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-artist-for-you {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-meta-for-you {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
        }

        /* Коллекции (для Тренды и Новинки) - остаются альбомами */
        .collections-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 15px;
            margin: 15px 0 40px;
        }

        .collection-card {
            background: rgba(26, 26, 26, 0.7);
            border-radius: 14px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            backdrop-filter: blur(5px);
        }

        .collection-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5), 0 0 20px rgba(255, 46, 46, 0.3);
        }

        .collection-image {
            width: 100%;
            height: 160px;
            object-fit: cover;
            transition: transform 0.6s ease;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.2));
        }

        .collection-card:hover .collection-image {
            transform: scale(1.05);
        }

        .collection-info {
            padding: 12px;
        }

        .collection-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .collection-artist {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .collection-stats {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.5);
        }

        .collection-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 700;
            margin-top: 5px;
        }

        .collection-badge.trending {
            background: var(--gradient-purple);
            color: white;
        }

        .collection-badge.new {
            background: var(--gradient-blue);
            color: white;
        }

        /* Страница альбома (для Тренды и Новинки) */
        .album-page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .album-page.active {
            display: block;
        }

        .album-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 15px;
            margin-bottom: 25px;
            padding: 25px;
            background: rgba(26, 26, 26, 0.7);
            border-radius: 14px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            backdrop-filter: blur(10px);
        }

        .album-cover-large {
            width: 200px;
            height: 200px;
            border-radius: 10px;
            object-fit: cover;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            flex-shrink: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.2));
        }

        .album-info {
            flex: 1;
            min-width: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .album-type {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.7);
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin-bottom: 6px;
            opacity: 0.8;
        }

        .album-name-large {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 6px;
            color: var(--text-primary);
            line-height: 1.2;
            word-wrap: break-word;
            overflow-wrap: break-word;
            text-align: center;
            max-width: 100%;
        }

        .album-artist-large {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }

        .album-meta-large {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .album-meta-large span {
            white-space: nowrap;
        }

        .album-actions {
            display: flex;
            justify-content: center;
            width: 100%;
            margin-top: 8px;
        }

        .play-album-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 10px 30px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            min-width: 180px;
            justify-content: center;
            white-space: nowrap;
        }

        .play-album-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4), 0 0 20px rgba(255, 46, 46, 0.3);
        }

        /* Список треков в альбоме */
        .tracks-list-section {
            margin-top: 30px;
        }

        .tracks-list-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .tracks-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .track-item-album {
            display: flex;
            align-items: center;
            padding: 10px 14px;
            background: rgba(26, 26, 26, 0.7);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .track-item-album:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 46, 46, 0.5);
            transform: translateX(5px);
        }

        .track-number-album {
            width: 35px;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.5);
            font-weight: 600;
            flex-shrink: 0;
            text-align: center;
        }

        .track-image-album {
            width: 45px;
            height: 45px;
            border-radius: 6px;
            object-fit: cover;
            margin-right: 12px;
            flex-shrink: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.2));
        }

        .track-info-album {
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }

        .track-title-album {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-artist-album {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-duration-album {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.5);
            flex-shrink: 0;
            margin-left: 12px;
            white-space: nowrap;
        }

        .back-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 15px;
            padding: 8px 0;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .back-btn:hover {
            color: var(--text-primary);
        }

        /* Player */
        .player {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 40px);
            max-width: 1200px;
            height: 60px;
            background: rgba(26, 26, 26, 0.8);
            border-radius: 12px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            gap: 12px;
            z-index: 999;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(20px);
        }

        .player-cover {
            width: 35px;
            height: 35px;
            border-radius: 6px;
            object-fit: cover;
            box-shadow: var(--shadow-md);
            flex-shrink: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.2));
        }

        .player-info {
            flex: 1;
            min-width: 0;
        }

        .player-title {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player-artist {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.7);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
        }

        .control-btn {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            flex-shrink: 0;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .control-btn.liked {
            background: var(--primary);
            border-color: var(--primary);
        }

        .control-btn.heart::before,
        .control-btn.next::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 16px;
            height: 16px;
            background: var(--text-primary);
            mask-position: center;
            mask-repeat: no-repeat;
            mask-size: contain;
        }

        .control-btn.liked::before {
            background: white;
        }

        .control-btn.heart::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z'/%3E%3C/svg%3E");
        }

        .control-btn.next::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z'/%3E%3C/svg%3E");
        }

        .play-btn {
            width: 42px;
            height: 42px;
            background: var(--gradient-primary);
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            flex-shrink: 0;
        }

        .play-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5), 0 0 20px rgba(255, 46, 46, 0.3);
        }

        .play-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 18px;
            height: 18px;
            background: white;
            mask-position: center;
            mask-repeat: no-repeat;
            mask-size: contain;
            transition: all 0.3s ease;
        }

        .play-btn.playing::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M6 19h4V5H6v14zm8-14v14h4V5h-4z'/%3E%3C/svg%3E");
        }

        .play-btn:not(.playing)::before {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M8 5v14l11-7z'/%3E%3C/svg%3E");
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 70px;
            background: rgba(26, 26, 26, 0.85);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            padding: 0;
            z-index: 1000;
        }

        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            padding: 10px 0;
            transition: all 0.2s ease;
            position: relative;
            min-height: 70px;
        }

        .nav-item:hover {
            color: var(--text-primary);
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 0 0 2px 2px;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            margin-bottom: 5px;
            background: currentColor;
            mask-position: center;
            mask-repeat: no-repeat;
            mask-size: contain;
        }

        .nav-item:nth-child(1) .nav-icon {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z'/%3E%3C/svg%3E");
        }

        .nav-item:nth-child(2) .nav-icon {
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8 12.5v-9l6 4.5-6 4.5z'/%3E%3C/svg%3E");
        }

        .nav-label {
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        /* Scrollbar */
        .main-content::-webkit-scrollbar {
            width: 5px;
        }

        .main-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .main-content::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }

        .main-content::-webkit-scrollbar-thumb:hover {
            background: var(--primary-light);
        }

        /* ИКОНКИ ДЛЯ КОЛЛЕКЦИЙ */
        .collection-icon {
            width: 14px;
            height: 14px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 3px;
            vertical-align: middle;
        }

        .icon-tracks {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ffffff'%3E%3Cpath d='M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z'/%3E%3C/svg%3E") center/contain no-repeat;
            opacity: 0.5;
        }

        .icon-plays {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ffffff'%3E%3Cpath d='M8 5v14l11-7z'/%3E%3C/svg%3E") center/contain no-repeat;
            opacity: 0.5;
        }

        /* Уведомления */
        .notification {
            position: fixed;
            top: 70px;
            right: 15px;
            background: rgba(33, 150, 243, 0.9);
            color: white;
            padding: 10px 16px;
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            z-index: 9999;
            animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s;
            max-width: 280px;
            word-wrap: break-word;
            font-size: 13px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }
        
        /* Адаптивность для мобильных устройств */
        @media (max-width: 400px) {
            .grid-3 {
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }
            
            .source-card {
                aspect-ratio: 1/1;
            }
            
            .mood-row {
                flex-wrap: wrap;
                justify-content: center;
                gap: 20px;
            }
            
            .mood-item {
                width: 45%;
            }
            
            .tracks-column {
                min-width: 300px;
            }
            
            .hero-action-btn {
                min-width: 140px;
                padding: 10px 20px;
            }
            
            .sound-hero-title {
                font-size: 28px;
            }
        }
    </style>
</head>
<body>
    <!-- Aurora Rhythm Background - новый растянутый фон -->
    <div class="aurora-rhythm-bg">
        <div class="aurora-spot aurora-spot-1"></div>
        <div class="aurora-spot aurora-spot-2"></div>
        <div class="aurora-spot aurora-spot-3"></div>
        <div class="aurora-spot aurora-spot-4"></div>
    </div>

    <!-- Header - ТЕПЕРЬ ПРОЗРАЧНЫЙ -->
    <div class="header">
        <div class="header-left">
            <button class="settings-btn" title="Настройки" onclick="openSettings()"></button>
        </div>

        <div class="search-bar">
            <div class="search-icon"></div>
            <input type="text" class="search-input" placeholder="Найти треки, исполнителей, альбомы">
        </div>

        <div class="header-right">
            <div class="user-avatar" id="userAvatar" onclick="showUserMenu()">
                <div class="user-avatar-placeholder">A</div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- БОЛЬШОЙ КОНТЕЙНЕР ДЛЯ ГЛАВНОЙ СТРАНИЦЫ -->
        <div class="main-container">
            <!-- Главная страница -->
            <div class="main-page" id="mainPage">
                <!-- Главная секция - Мой ритм - ПОДНЯТА ВВЕРХ -->
                <div class="sound-hero-section">
                    <h1 class="sound-hero-title">МОЙ РИТМ</h1>
                    <div class="sound-hero-subtitle">
                        Персональные рекомендации на основе ваших предпочтений
                    </div>

                    <!-- Анимация полос -->
                    <div class="sound-visualizer" id="soundVisualizer"></div>

                    <div class="sound-hero-actions">
                        <button class="hero-action-btn primary" onclick="openSoundSettings()">
                            Настроить звук
                        </button>
                        <button class="hero-action-btn secondary" onclick="playSound()">
                            Слушать
                        </button>
                    </div>

                    <!-- СЛАЙДЕР С ПОДНЯТЫМ МЕСТОПОЛОЖЕНИЕМ -->
                    <div class="image-container">
                        <img src="https://raw.githubusercontent.com/CarFix77/Frog/refs/heads/main/5B1EE03A-3DBE-4A3B-A99E-BDABEF05AC65.jpeg" 
                             alt="MyRhythm" 
                             class="main-image">
                        <!-- Текст появляется только при наведении -->
                        <div class="image-overlay">
                            <div class="image-title">MyRhythm</div>
                        </div>
                    </div>
                </div>

                <!-- РАСШИРЕННЫЙ КОНТЕЙНЕР С ИСПРАВЛЕННЫМ ОТСТУПОМ -->
                <div class="content-container">
                    <!-- Подборки музыки -->
                    <div class="moods-section">
                        <h2 class="section-title">Подборки музыки</h2>
                        <div class="moods-grid">
                            <div class="mood-card" onclick="openCategory('genres')">
                                <div class="mood-title">
                                    <div class="mood-icon"></div>
                                    Жанры
                                </div>
                                <div class="mood-subtitle">Рок, поп, хип-хоп, джаз, электроника</div>
                            </div>
                            <div class="mood-card" onclick="openCategory('activities')">
                                <div class="mood-title">
                                    <div class="mood-icon"></div>
                                    Занятия
                                </div>
                                <div class="mood-subtitle">Для работы, тренировки, отдыха, учебы</div>
                            </div>
                            <div class="mood-card" onclick="openCategory('moods')">
                                <div class="mood-title">
                                    <div class="mood-icon"></div>
                                    Настроения
                                </div>
                                <div class="mood-subtitle">Веселое, грустное, энергичное, спокойное</div>
                            </div>
                        </div>
                    </div>

                    <!-- Табы контента -->
                    <div class="content-tabs">
                        <button class="tab active" onclick="switchTab('for-you')">Для вас</button>
                        <button class="tab" onclick="switchTab('trends')">Тренды</button>
                        <button class="tab" onclick="switchTab('new')">Новинки</button>
                    </div>

                    <!-- Контент для таба "Для вас" -->
                    <div class="tab-content active" id="tab-for-you">
                        <div class="for-you-section">
                            <div class="for-you-header">
                                <div>
                                    <div class="for-you-title">На основе ваших предпочтений</div>
                                    <div class="for-you-subtitle">Треки, которые вам понравятся</div>
                                </div>
                                <div class="scroll-buttons">
                                    <button class="scroll-btn prev" onclick="scrollTracksColumns('prev')"></button>
                                    <button class="scroll-btn next" onclick="scrollTracksColumns('next')"></button>
                                </div>
                            </div>

                            <!-- КОНТЕЙНЕР ДЛЯ КОЛОНОК -->
                            <div class="tracks-columns-container" id="tracksColumnsContainer">
                                <!-- Колонки заполняются динамически -->
                            </div>

                            <!-- ИНДИКАТОРЫ ПРОКРУТКИ - ТОЧКИ -->
                            <div class="scroll-indicators" id="scrollIndicators">
                                <!-- Точки заполняются динамически -->
                            </div>
                        </div>
                    </div>

                    <!-- Контент для таба "Тренды" - АЛЬБОМЫ -->
                    <div class="tab-content" id="tab-trends">
                        <div class="collections-grid" id="grid-trends">
                            <!-- Заполняется динамически -->
                        </div>
                    </div>

                    <!-- Контент для таба "Новинки" - АЛЬБОМЫ -->
                    <div class="tab-content" id="tab-new">
                        <div class="collections-grid" id="grid-new">
                            <!-- Заполняется динамически -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Страница настроек звука (НОВЫЙ ДИЗАЙН) -->
            <div class="sound-settings-page" id="soundSettingsPage">
                <button class="back-btn" onclick="goBack()">
                    ← Назад
                </button>

                <h1>Настроить Ритм</h1>

                <section>
                    <span class="label">занятие</span>
                    <div class="scroll-row">
                        <div class="pill active" onclick="toggleActivity(this)">В дороге</div>
                        <div class="pill" onclick="toggleActivity(this)">Работа</div>
                        <div class="pill" onclick="toggleActivity(this)">Тренировка</div>
                        <div class="pill" onclick="toggleActivity(this)">Дом</div>
                        <div class="pill" onclick="toggleActivity(this)">Сон</div>
                    </div>
                </section>

                <section>
                    <span class="label">источник</span>
                    <div class="grid-3">
                        <!-- 3D Сердце -->
                        <div class="source-card active" onclick="toggleSource(this)">
                            <div class="icon-box">
                                <svg viewBox="0 0 50 50" width="44" height="44">
                                    <defs>
                                        <radialGradient id="heartGrad" cx="30%" cy="30%" r="70%">
                                            <stop offset="0%" stop-color="#ff6b6b"/>
                                            <stop offset="100%" stop-color="#8a0000"/>
                                        </radialGradient>
                                        <filter id="shadow"><feDropShadow dx="0" dy="4" stdDeviation="3" opacity="0.5"/></filter>
                                    </defs>
                                    <path fill="url(#heartGrad)" filter="url(#shadow)" d="M25,40l-2.4-2.2C14.1,30.2,8,24.7,8,18c0-5.5,4.5-10,10-10c3.1,0,6.1,1.4,8,3.7c1.9-2.2,4.9-3.7,8-3.7c5.5,0,10,4.5,10,10c0,6.7-6.1,12.2-14.6,19.8L25,40z"/>
                                    <ellipse cx="20" cy="15" rx="4" ry="2" fill="white" fill-opacity="0.2" transform="rotate(-30 20 15)"/>
                                </svg>
                            </div>
                            <span>избранное</span>
                        </div>
                        <!-- 3D Тренды -->
                        <div class="source-card" onclick="toggleSource(this)">
                            <div class="icon-box">
                                <svg viewBox="0 0 50 50" width="44" height="44">
                                    <defs>
                                        <linearGradient id="trendGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" stop-color="#ffcc33"/>
                                            <stop offset="100%" stop-color="#ff6600"/>
                                        </linearGradient>
                                        <filter id="shadow"><feDropShadow dx="0" dy="4" stdDeviation="3" opacity="0.5"/></filter>
                                    </defs>
                                    <rect x="10" y="25" width="6" height="15" rx="2" fill="url(#trendGrad)" filter="url(#shadow)"/>
                                    <rect x="22" y="15" width="6" height="25" rx="2" fill="url(#trendGrad)" filter="url(#shadow)"/>
                                    <rect x="34" y="20" width="6" height="20" rx="2" fill="url(#trendGrad)" filter="url(#shadow)"/>
                                </svg>
                            </div>
                            <span>трендовое</span>
                        </div>
                        <!-- 3D Новое -->
                        <div class="source-card" onclick="toggleSource(this)">
                            <div class="icon-box">
                                <svg viewBox="0 0 50 50" width="44" height="44">
                                    <defs>
                                        <radialGradient id="starGrad" cx="30%" cy="30%" r="70%">
                                            <stop offset="0%" stop-color="#4facfe"/>
                                            <stop offset="100%" stop-color="#0061ff"/>
                                        </radialGradient>
                                        <filter id="shadow"><feDropShadow dx="0" dy="4" stdDeviation="3" opacity="0.5"/></filter>
                                    </defs>
                                    <path fill="url(#starGrad)" filter="url(#shadow)" d="M25,5l6.5,13.5L46,20.5l-10.5,10L38,45L25,38L12,45l2.5-14.5L4,20.5l14.5-2L25,5z"/>
                                </svg>
                            </div>
                            <span>новое</span>
                        </div>
                    </div>
                </section>

                <section>
                    <span class="label">настроение</span>
                    <div class="mood-row">
                        <div class="mood-item active" onclick="toggleMood(this)">
                            <div class="sphere s-red"></div><span>Бодрое</span>
                        </div>
                        <div class="mood-item" onclick="toggleMood(this)">
                            <div class="sphere s-green"></div><span>Весёлое</span>
                        </div>
                        <div class="mood-item" onclick="toggleMood(this)">
                            <div class="sphere s-blue"></div><span>Спокойное</span>
                        </div>
                        <div class="mood-item" onclick="toggleMood(this)">
                            <div class="sphere s-gold"></div><span>Грустное</span>
                        </div>
                    </div>
                </section>

                <section>
                    <span class="label">авторы</span>
                    <div class="authors-list" id="auth-list">
                        <!-- JS вставит кнопку и авторов -->
                    </div>
                </section>

                <div class="sound-settings-footer">
                    <button class="reset-sound-button" onclick="resetAllSettings()">
                        СБРОСИТЬ ВСЁ
                    </button>
                </div>
            </div>

            <!-- ШТОРКА ДЛЯ АВТОРОВ -->
            <div class="overlay" id="overlay" onclick="closeDrawer()"></div>
            <div class="drawer" id="drawer">
                <div style="width:40px; height:4px; background:#333; margin:0 auto 20px; border-radius:10px;"></div>
                <input type="text" class="search-box" placeholder="Найти автора..." id="searchInput" oninput="filterAuthors()">
                <div class="drawer-grid" id="drawer-list"></div>
            </div>

            <!-- Страница настроек -->
            <div class="settings-page" id="settingsPage">
                <button class="back-btn" onclick="goBack()">
                    ← Назад
                </button>

                <!-- Язык -->
                <div class="settings-section">
                    <h2 class="settings-title language">Язык</h2>
                    <div class="languages-grid" id="languagesGrid">
                        <!-- Заполняется динамически -->
                    </div>
                </div>

                <!-- Техподдержка -->
                <div class="settings-section">
                    <h2 class="settings-title support">Техподдержка</h2>
                    <div class="support-options">
                        <div class="support-option" onclick="contactSupport('chat')">
                            <div class="support-icon"></div>
                            <div class="support-info">
                                <div class="support-title">Онлайн-чат</div>
                                <div class="support-description">Быстрые ответы на ваши вопросы 24/7</div>
                            </div>
                        </div>
                        <div class="support-option" onclick="contactSupport('email')">
                            <div class="support-icon"></div>
                            <div class="support-info">
                                <div class="support-title">Email поддержка</div>
                                <div class="support-description">Подробные ответы на complex@support.myrhythm.com</div>
                            </div>
                        </div>
                        <div class="support-option" onclick="openFAQ()">
                            <div class="support-icon"></div>
                            <div class="support-info">
                                <div class="support-title">FAQ и помощь</div>
                                <div class="support-description">Ответы на часто задаваемые вопросы</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Управление подпиской -->
                <div class="settings-section">
                    <div class="subscription-header">
                        <h1 class="subscription-title" id="subscriptionTitleText">ПОДПИСКА</h1>
                        <div class="subscription-subtitle" id="subscriptionSubtitleText">
                            Выберите подходящий план подписки
                        </div>
                    </div>

                    <div class="subscription-plans" id="subscriptionPlans">
                        <!-- Заполняется динамически -->
                    </div>

                    <!-- Контейнер для промокода -->
                    <div class="promocode-container">
                        <div class="promocode-title">Промокод</div>
                        <div class="promocode-input-container">
                            <input type="text" class="promocode-input" placeholder="Введите промокод" id="promocodeInput">
                            <button class="promocode-btn" onclick="applyPromocode()">Применить</button>
                        </div>
                        <div class="promocode-description" id="promocodeDescriptionText">
                            Введите промокод для получения скидки на подписку
                        </div>
                    </div>
                </div>
            </div>

            <!-- Страница коллекции -->
            <div class="collection-page" id="collectionPage">
                <button class="back-btn" onclick="goBack()">
                    ← Назад
                </button>

                <!-- Пока коллекция пуста -->
                <div class="empty-collection" id="emptyCollection" style="display: block;">
                    <div class="empty-icon">🎵</div>
                    <div class="empty-title">Коллекция пуста</div>
                    <div class="empty-subtitle">
                        Чтобы добавить трек в коллекцию, нажмите на сердечко ❤️ рядом с ним
                    </div>
                </div>

                <!-- Когда появляются треки -->
                <div class="collection-grid" id="collectionGrid" style="display: none;">
                    <!-- Заполняется динамически при добавлении треков -->
                </div>
            </div>

            <!-- Страница альбома -->
            <div class="album-page" id="albumPage">
                <button class="back-btn" onclick="goBack()">
                    ← Назад
                </button>
                <div class="album-header" id="albumHeader">
                    <!-- Заполняется динамически -->
                </div>
                <div class="tracks-list-section">
                    <div class="tracks-list-title">Треки</div>
                    <div class="tracks-container" id="tracksList">
                        <!-- Заполняется динамически -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Player -->
    <div class="player">
        <div class="player-cover"></div>
        <div class="player-info">
            <div class="player-title">Выберите трек</div>
            <div class="player-artist">Нажмите на трек или альбом</div>
        </div>
        <div class="player-controls">
            <button class="control-btn heart" id="playerHeartBtn"></button>
            <button class="play-btn" id="playerPlayBtn"></button>
            <button class="control-btn next"></button>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <button class="nav-item active" onclick="switchPage('music')">
            <div class="nav-icon"></div>
            <div class="nav-label">Музыка</div>
        </button>
        <button class="nav-item" onclick="switchPage('collection')">
            <div class="nav-icon"></div>
            <div class="nav-label">Коллекция</div>
        </button>
    </div>

    <script>
        // Состояние приложения
        let currentPage = 'music';
        let currentTab = 'for-you';
        let currentAlbum = null;
        let currentTrack = null;
        let isPlaying = false;
        let soundConfigured = false;
        let userPreferences = [];
        let likedTracks = new Set();
        let currentLanguage = 'ru';
        let currentColumnIndex = 0;

        // Настройки звука - новое состояние
        let currentSoundSettings = {
            activity: 'В дороге',
            source: 'избранное',
            mood: 'Бодрое',
            authors: []
        };

        // Авторы для настроек звука
        const authors = [
            { n: 'Aphex Twin', id: 1 },
            { n: 'Burial', id: 2 },
            { n: 'Moby', id: 3 },
            { n: 'Lorn', id: 4 },
            { n: 'Kiasmos', id: 5 },
            { n: 'Moderat', id: 6 },
            { n: 'Hans Zimmer', id: 7 },
            { n: 'Daft Punk', id: 8 },
            { n: 'Bonobo', id: 9 },
            { n: 'Massive Attack', id: 10 },
            { n: 'Thom Yorke', id: 11 },
            { n: 'Four Tet', id: 12 }
        ];

        // Тестовые изображения
        const testImages = [
            'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1511379938547-c1f69419868d?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1518609878373-06d740f60d8b?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1519281682544-5b00a8dc84ea?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1487180144351-b8472da7d491?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1529255484355-cb73c33c04bb?w=400&h=400&fit=crop'
        ];

        // Треки для раздела "Для вас"
        const forYouTracks = [
            {
                id: 'fy-1',
                title: 'Рассвет',
                artist: 'Miyagi & Andy Panda',
                album: 'Yamakasi',
                duration: '3:45',
                year: 2024,
                plays: '2.5M',
                mood: 'Спокойное',
                genre: 'Хип-хоп',
                image: testImages[0]
            },
            {
                id: 'fy-2',
                title: 'Энергия',
                artist: 'The Weeknd',
                album: 'Dawn FM',
                duration: '4:20',
                year: 2023,
                plays: '5.1M',
                mood: 'Энергичное',
                genre: 'Поп',
                image: testImages[1]
            },
            {
                id: 'fy-3',
                title: 'Дорога',
                artist: 'Кис-кис',
                album: 'Между нами',
                duration: '3:15',
                year: 2024,
                plays: '1.8M',
                mood: 'Путешествие',
                genre: 'Рок',
                image: testImages[2]
            },
            {
                id: 'fy-4',
                title: 'Тишина',
                artist: 'Billie Eilish',
                album: 'Happier Than Ever',
                duration: '4:05',
                year: 2023,
                plays: '3.2M',
                mood: 'Спокойное',
                genre: 'Поп',
                image: testImages[3]
            },
            {
                id: 'fy-5',
                title: 'Фокус',
                artist: 'Hans Zimmer',
                album: 'Interstellar OST',
                duration: '5:30',
                year: 2024,
                plays: '1.2M',
                mood: 'Концентрация',
                genre: 'Саундтрек',
                image: testImages[4]
            },
            {
                id: 'fy-6',
                title: 'Воспоминания',
                artist: 'Макс Корж',
                album: 'Малый повзрослел',
                duration: '3:50',
                year: 2024,
                plays: '4.3M',
                mood: 'Ностальгия',
                genre: 'Поп',
                image: testImages[5]
            },
            {
                id: 'fy-7',
                title: 'Лето',
                artist: 'Монеточка',
                album: 'Раскраски для взрослых',
                duration: '2:55',
                year: 2024,
                plays: '2.1M',
                mood: 'Веселое',
                genre: 'Поп',
                image: testImages[6]
            },
            {
                id: 'fy-8',
                title: 'Ночь',
                artist: 'LSP',
                album: 'Tragic City',
                duration: '4:10',
                year: 2024,
                plays: '3.8M',
                mood: 'Вечернее',
                genre: 'Хип-хоп',
                image: testImages[7]
            },
            {
                id: 'fy-9',
                title: 'Город',
                artist: 'Noize MC',
                album: 'Царь горы',
                duration: '3:25',
                year: 2024,
                plays: '2.7M',
                mood: 'Городское',
                genre: 'Хип-хоп',
                image: testImages[0]
            },
            {
                id: 'fy-10',
                title: 'Океан',
                artist: 'Imagine Dragons',
                album: 'Mercury',
                duration: '4:15',
                year: 2023,
                plays: '3.5M',
                mood: 'Эпическое',
                genre: 'Рок',
                image: testImages[1]
            },
            {
                id: 'fy-11',
                title: 'Мечта',
                artist: 'BTS',
                album: 'Love Yourself',
                duration: '3:45',
                year: 2024,
                plays: '4.8M',
                mood: 'Вдохновляющее',
                genre: 'K-pop',
                image: testImages[2]
            },
            {
                id: 'fy-12',
                title: 'Полет',
                artist: 'M83',
                album: 'Hurry Up',
                duration: '5:10',
                year: 2024,
                plays: '1.9M',
                mood: 'Космическое',
                genre: 'Электроника',
                image: testImages[3]
            }
        ];

        // Альбомы для разделов "Тренды" и "Новинки"
        const albumsDatabase = {
            trends: [
                {
                    id: 'trend-1',
                    title: 'Громкие новинки месяца',
                    artist: 'Их ждали!',
                    plays: '8.2M',
                    tracks: 3,
                    year: 2024,
                    type: 'Сборник',
                    duration: '12:45',
                    badge: 'trending',
                    image: testImages[0],
                    tracksList: [
                        {
                            id: 't1-1',
                            title: 'Аста ла виста',
                            artist: 'Окрытонит, FEDUK',
                            album: 'Громкие новинки месяца',
                            duration: '3:15',
                            year: 2024,
                            plays: '4.2M',
                            image: testImages[0],
                            mood: 'Энергичное',
                            genre: 'Хип-хоп'
                        },
                        {
                            id: 't1-2',
                            title: 'Романтик и Вандал',
                            artist: 'BIUSHDO ZHO',
                            album: 'Громкие новинки месяца',
                            duration: '4:30',
                            year: 2024,
                            plays: '3.1M',
                            image: testImages[1],
                            mood: 'Эмоциональное',
                            genre: 'Хип-хоп'
                        },
                        {
                            id: 't1-3',
                            title: 'БЕСИТСЯ',
                            artist: 'ToxiS, Big Baby Tape',
                            album: 'Громкие новинки месяца',
                            duration: '5:00',
                            year: 2024,
                            plays: '2.8M',
                            image: testImages[2],
                            mood: 'Агрессивное',
                            genre: 'Хип-хоп'
                        }
                    ]
                },
                {
                    id: 'trend-2',
                    title: 'TikTok хиты',
                    artist: 'Вирусные треки',
                    plays: '12.4M',
                    tracks: 5,
                    year: 2024,
                    type: 'Плейлист',
                    duration: '18:30',
                    badge: 'trending',
                    image: testImages[1],
                    tracksList: []
                },
                {
                    id: 'trend-3',
                    title: '2024 Чарты',
                    artist: 'Популярное',
                    plays: '6.9M',
                    tracks: 4,
                    year: 2024,
                    type: 'Сборник',
                    duration: '15:45',
                    badge: 'trending',
                    image: testImages[2],
                    tracksList: []
                }
            ],
            new: [
                {
                    id: 'new-1',
                    title: 'Свежие релизы',
                    artist: 'Новинки недели',
                    plays: '2.1M',
                    tracks: 3,
                    year: 2024,
                    type: 'Сборник',
                    duration: '10:30',
                    badge: 'new',
                    image: testImages[3],
                    tracksList: []
                },
                {
                    id: 'new-2',
                    title: 'Только вышло',
                    artist: 'Новый месяц',
                    plays: '1.8M',
                    tracks: 2,
                    year: 2024,
                    type: 'Плейлист',
                    duration: '7:50',
                    badge: 'new',
                    image: testImages[4],
                    tracksList: []
                },
                {
                    id: 'new-3',
                    title: 'Эксклюзив',
                    artist: 'MyRhythm',
                    plays: '3.2M',
                    tracks: 2,
                    year: 2024,
                    type: 'Эксклюзив',
                    duration: '8:15',
                    badge: 'new',
                    image: testImages[5],
                    tracksList: []
                }
            ]
        };

        // Языки
        const languages = [
            { code: 'ru', name: 'Русский', native: 'Русский', flag: 'https://flagcdn.com/w320/ru.png' },
            { code: 'en', name: 'Английский', native: 'English', flag: 'https://flagcdn.com/w320/gb.png' }
        ];

        // Инициализация
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            createVisualizerBars();
            loadTracksColumns();
            loadTabContent('trends');
            loadTabContent('new');
            loadLanguages();
            loadSubscriptionPlans();
            createFloatingParticles();
            loadRandomAuthors();
        });

        // Загрузка случайных авторов
        function loadRandomAuthors() {
            const container = document.getElementById('auth-list');
            if (!container) return;

            const shuffled = [...authors].sort(() => 0.5 - Math.random()).slice(0, 4);
            let html = '<div class="btn-trigger" onclick="openDrawer()"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2.5"><path d="M6 9l6 6 6-6"/></svg></div>';
            shuffled.forEach(a => {
                html += '<div class="author-circle"><div class="author-img"><img src="https://i.pravatar.cc/100?u=' + a.id + '"></div><span>' + a.n.split(' ')[0] + '</span></div>';
            });
            container.innerHTML = html;
        }

        // Открытие шторки с авторами
        function openDrawer() {
            document.getElementById('overlay').classList.add('active');
            document.getElementById('drawer').classList.add('active');
            filterAuthors();
        }

        // Закрытие шторки
        function closeDrawer() {
            document.getElementById('overlay').classList.remove('active');
            document.getElementById('drawer').classList.remove('active');
        }

        // Фильтрация авторов в шторке
        function filterAuthors() {
            const q = document.getElementById('searchInput').value.toLowerCase();
            const list = document.getElementById('drawer-list');
            list.innerHTML = '';
            authors.filter(a => a.n.toLowerCase().includes(q)).forEach(a => {
                list.innerHTML += '<div class="author-circle" onclick="selectAuthor(this)"><div class="author-img"><img src="https://i.pravatar.cc/100?u=' + a.id + '"></div><span>' + a.n.split(' ')[0] + '</span></div>';
            });
        }

        // Выбор автора
        function selectAuthor(el) {
            const authorName = el.querySelector('span').textContent;
            showNotification('Автор ' + authorName + ' выбран');
            closeDrawer();
        }

        // Переключение активности
        function toggleActivity(el) {
            const parent = el.parentElement;
            parent.querySelectorAll('.active').forEach(item => item.classList.remove('active'));
            el.classList.add('active');
            currentSoundSettings.activity = el.textContent;
            showNotification('Занятие: ' + el.textContent);
        }

        // Переключение источника
        function toggleSource(el) {
            const parent = el.parentElement;
            parent.querySelectorAll('.active').forEach(item => item.classList.remove('active'));
            el.classList.add('active');
            currentSoundSettings.source = el.querySelector('span').textContent;
            showNotification('Источник: ' + currentSoundSettings.source);
        }

        // Переключение настроения
        function toggleMood(el) {
            const parent = el.parentElement;
            parent.querySelectorAll('.active').forEach(item => item.classList.remove('active'));
            el.classList.add('active');
            currentSoundSettings.mood = el.querySelector('span').textContent;
            showNotification('Настроение: ' + currentSoundSettings.mood);
        }

        // Сброс всех настроек
        function resetAllSettings() {
            // Сброс занятий
            const activities = document.querySelectorAll('.pill');
            activities.forEach((item, index) => {
                item.classList.toggle('active', index === 0);
                if (index === 0) currentSoundSettings.activity = item.textContent;
            });

            // Сброс источников
            const sources = document.querySelectorAll('.source-card');
            sources.forEach((item, index) => {
                item.classList.toggle('active', index === 0);
                if (index === 0) currentSoundSettings.source = item.querySelector('span').textContent;
            });

            // Сброс настроений
            const moods = document.querySelectorAll('.mood-item');
            moods.forEach((item, index) => {
                item.classList.toggle('active', index === 0);
                if (index === 0) currentSoundSettings.mood = item.querySelector('span').textContent;
            });

            // Сброс авторов
            currentSoundSettings.authors = [];
            loadRandomAuthors();

            soundConfigured = false;
            showNotification('Все настройки сброшены');
        }

        // Создание визуализатора полос
        function createVisualizerBars() {
            const visualizer = document.getElementById('soundVisualizer');
            if (!visualizer) return;

            visualizer.innerHTML = '';
            for (let i = 0; i < 12; i++) {
                const bar = document.createElement('div');
                bar.className = 'visualizer-bar';
                bar.style.height = `${12 + Math.random() * 38}px`;
                bar.style.animationDelay = `${i * 0.1}s`;
                visualizer.appendChild(bar);
            }
        }

        // Создание парящих частиц
        function createFloatingParticles() {
            const bg = document.querySelector('.aurora-rhythm-bg');
            if (!bg) return;

            for (let i = 0; i < 15; i++) {
                const particle = document.createElement('div');
                particle.className = 'floating-particle';
                const size = Math.random() * 4 + 1;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.animationDelay = `${Math.random() * 15}s`;
                particle.style.animationDuration = `${15 + Math.random() * 15}s`;
                bg.appendChild(particle);
            }
        }

        // Загрузка треков в колонки
        function loadTracksColumns() {
            const container = document.getElementById('tracksColumnsContainer');
            const indicators = document.getElementById('scrollIndicators');
            if (!container || !indicators) return;

            container.innerHTML = '';
            indicators.innerHTML = '';

            // Разделяем треки на колонки по 3 трека в каждой
            const tracksPerColumn = 3;
            const columnCount = Math.ceil(forYouTracks.length / tracksPerColumn);

            // Создаем индикаторы
            for (let i = 0; i < columnCount; i++) {
                const dot = document.createElement('div');
                dot.className = `scroll-indicator-dot ${i === 0 ? 'active' : ''}`;
                dot.onclick = () => scrollToColumn(i);
                indicators.appendChild(dot);
            }

            for (let colIndex = 0; colIndex < columnCount; colIndex++) {
                const column = document.createElement('div');
                column.className = 'tracks-column';

                const startIndex = colIndex * tracksPerColumn;
                const endIndex = Math.min(startIndex + tracksPerColumn, forYouTracks.length);
                const columnTracks = forYouTracks.slice(startIndex, endIndex);

                columnTracks.forEach(track => {
                    const card = document.createElement('div');
                    card.className = 'track-card-for-you';
                    card.onclick = () => openTrack(track, 'for-you');

                    const img = document.createElement('img');
                    img.className = 'track-image-for-you';
                    img.src = track.image;
                    img.alt = track.title;

                    card.appendChild(img);

                    const infoDiv = document.createElement('div');
                    infoDiv.className = 'track-info-for-you';

                    infoDiv.innerHTML = `
                        <div>
                            <div class="track-title-for-you">${track.title}</div>
                            <div class="track-artist-for-you">${track.artist}</div>
                        </div>
                        <div class="track-meta-for-you">
                            <span>${track.duration}</span>
                            <span>•</span>
                            <span>${track.plays}</span>
                        </div>
                    `;

                    card.appendChild(infoDiv);
                    column.appendChild(card);
                });

                container.appendChild(column);
            }
        }

        // Скролл к конкретной колонке
        function scrollToColumn(index) {
            const container = document.getElementById('tracksColumnsContainer');
            if (!container) return;

            const columnWidth = 350 + 20;
            container.scrollTo({
                left: index * columnWidth,
                behavior: 'smooth'
            });

            updateIndicators(index);
        }

        // Обновление индикаторов
        function updateIndicators(index) {
            const indicators = document.getElementById('scrollIndicators');
            if (!indicators) return;

            const dots = indicators.querySelectorAll('.scroll-indicator-dot');
            dots.forEach((dot, i) => {
                if (i === index) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });

            currentColumnIndex = index;
        }

        // Загрузка контента для таба
        function loadTabContent(tabId) {
            const grid = document.getElementById(`grid-${tabId}`);
            if (!grid) return;

            const albums = albumsDatabase[tabId];
            if (!albums) return;

            grid.innerHTML = '';

            albums.forEach(album => {
                const card = document.createElement('div');
                card.className = 'collection-card';
                card.onclick = () => openAlbum(album, tabId);

                const badgeText = album.badge === 'trending' ? 'ТРЕНД' : 'НОВОЕ';
                const badgeClass = album.badge === 'trending' ? 'trending' : 'new';

                const badge = badgeText ? `<div class="collection-badge ${badgeClass}">${badgeText}</div>` : '';

                card.innerHTML = `
                    <img src="${album.image}" class="collection-image" alt="${album.title}">
                    <div class="collection-info">
                        <div class="collection-title">${album.title}</div>
                        <div class="collection-artist">${album.artist}</div>
                        <div class="collection-stats">
                            <span>
                                <div class="collection-icon icon-tracks"></div>
                                ${album.tracks} треков
                            </span>
                            <span>
                                <div class="collection-icon icon-plays"></div>
                                ${album.plays} прослушиваний
                            </span>
                        </div>
                        ${badge}
                    </div>
                `;

                grid.appendChild(card);
            });
        }

        // Загрузка языков
        function loadLanguages() {
            const languagesGrid = document.getElementById('languagesGrid');
            if (!languagesGrid) return;

            languagesGrid.innerHTML = '';

            languages.forEach(lang => {
                const option = document.createElement('div');
                option.className = `language-option ${lang.code === currentLanguage ? 'active' : ''}`;
                option.onclick = () => changeLanguage(lang.code);

                option.innerHTML = `
                    <img src="${lang.flag}" class="language-flag" alt="${lang.name}">
                    <div class="language-info">
                        <div class="language-name">${lang.name}</div>
                        <div class="language-natives">${lang.native}</div>
                    </div>
                `;

                languagesGrid.appendChild(option);
            });
        }

        // Загрузка подписок
        function loadSubscriptionPlans() {
            const plansContainer = document.getElementById('subscriptionPlans');
            if (!plansContainer) return;

            plansContainer.innerHTML = '';

            const plans = [
                {
                    id: 'yearly',
                    period: 'ГОД',
                    price: '4.99',
                    savings: 'Экономия 50%',
                    features: [
                        'Высокое качество звука',
                        'Скачивание треков',
                        'Прослушивание без рекламы',
                        'Персональные рекомендации',
                        'Эксклюзивный контент',
                        'Приоритетная поддержка'
                    ],
                    popular: true
                },
                {
                    id: 'half-year',
                    period: 'ПОЛГОДА',
                    price: '2.99',
                    savings: 'Экономия 40%',
                    features: [
                        'Высокое качество звука',
                        'Ограниченное скачивание',
                        'Прослушивание без рекламы',
                        'Персональные рекомендации',
                        'Приоритетная поддержка'
                    ],
                    popular: false
                },
                {
                    id: 'monthly',
                    period: 'МЕСЯЦ',
                    price: '0.99',
                    savings: '',
                    features: [
                        'Стандартное качество',
                        'Без скачивания',
                        'Прослушивание без рекламы',
                        'Базовые рекомендации'
                    ],
                    popular: false
                }
            ];

            plans.forEach(plan => {
                const planCard = document.createElement('div');
                planCard.className = `plan-card ${plan.id} ${plan.popular ? 'popular' : ''}`;

                const featuresHtml = plan.features.map(feature => 
                    `<div class="plan-feature">${feature}</div>`
                ).join('');

                const savingsHtml = plan.savings ? 
                    `<div class="plan-savings">${plan.savings}</div>` : '';

                planCard.innerHTML = `
                    <div class="plan-header">
                        <div class="plan-period">${plan.period}</div>
                        <div class="plan-price-container">
                            <div class="plan-price">${plan.price}</div>
                            <div class="plan-currency">
                                <div class="ton-icon">
                                    <svg width="20" height="20" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="50" cy="50" r="50" fill="#0098EA"/>
                                        <path d="M72 36C72 31.5 68.5 28 64 28H36C31.5 28 28 31.5 28 36V38C28 39.5 28.5 41 29.5 42L47.5 69C48.5 70.5 51.5 70.5 52.5 69L70.5 42C71.5 41 72 39.5 72 38V36Z" stroke="white" stroke-width="6" stroke-linejoin="round"/>
                                        <path d="M50 28V68" stroke="white" stroke-width="6" stroke-linecap="round"/>
                                    </svg>
                                </div>
                                TON
                            </div>
                        </div>
                        ${savingsHtml}
                    </div>
                    <div class="plan-features">
                        ${featuresHtml}
                    </div>
                    <button class="plan-button" onclick="subscribeToPlan('${plan.id}', '${plan.price}')">
                        КУПИТЬ ПОДПИСКУ
                    </button>
                `;

                plansContainer.appendChild(planCard);
            });
        }

        // Переключение табов
        function switchTab(tabId) {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            const activeTab = document.querySelector(`.tab[onclick="switchTab('${tabId}')"]`);
            const activeContent = document.getElementById(`tab-${tabId}`);

            if (activeTab) activeTab.classList.add('active');
            if (activeContent) activeContent.classList.add('active');

            currentTab = tabId;
        }

        // Переключение страниц
        function switchPage(pageId) {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            const activeNav = document.querySelector(`.nav-item[onclick="switchPage('${pageId}')"]`);
            if (activeNav) activeNav.classList.add('active');

            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('settingsPage').style.display = 'none';
            document.getElementById('collectionPage').style.display = 'none';
            document.getElementById('albumPage').style.display = 'none';
            document.getElementById('soundSettingsPage').style.display = 'none';

            // Добавляем/убираем класс для управления фоном Aurora
            if (pageId === 'settings' || pageId === 'collection' || pageId === 'album' || pageId === 'sound-settings') {
                document.body.classList.add('settings-mode');
            } else {
                document.body.classList.remove('settings-mode');
            }

            switch(pageId) {
                case 'music':
                    document.getElementById('mainPage').style.display = 'block';
                    break;
                case 'settings':
                    document.getElementById('settingsPage').style.display = 'block';
                    break;
                case 'collection':
                    document.getElementById('collectionPage').style.display = 'block';
                    updateCollectionPage();
                    break;
            }

            currentPage = pageId;
        }

        // Обновление страницы коллекции
        function updateCollectionPage() {
            const emptyCollection = document.getElementById('emptyCollection');
            const collectionGrid = document.getElementById('collectionGrid');

            const likedTracksArray = Array.from(likedTracks).map(trackId => 
                forYouTracks.find(t => t.id === trackId) ||
                albumsDatabase.trends.flatMap(a => a.tracksList).find(t => t?.id === trackId) ||
                albumsDatabase.new.flatMap(a => a.tracksList).find(t => t?.id === trackId)
            ).filter(Boolean);

            if (likedTracksArray.length === 0) {
                emptyCollection.style.display = 'block';
                collectionGrid.style.display = 'none';
            } else {
                emptyCollection.style.display = 'none';
                collectionGrid.style.display = 'grid';

                collectionGrid.innerHTML = '';

                likedTracksArray.forEach(track => {
                    const item = document.createElement('div');
                    item.className = 'collection-track-item';
                    item.onclick = () => playTrackFromCollection(track);

                    item.innerHTML = `
                        <img src="${track.image}" class="collection-track-image" alt="${track.title}">
                        <div class="collection-track-info">
                            <div class="collection-track-title">${track.title}</div>
                            <div class="collection-track-artist">${track.artist}</div>
                            <div class="collection-track-meta">
                                <span>${track.duration}</span>
                                <span>•</span>
                                <span>${track.year}</span>
                            </div>
                        </div>
                    `;

                    collectionGrid.appendChild(item);
                });
            }
        }

        // Открытие настроек
        function openSettings() {
            switchPage('settings');
        }

        // Открытие трека
        function openTrack(track, source) {
            currentTrack = track;

            updatePlayer({
                title: track.title,
                artist: track.artist,
                album: track.album,
                image: track.image,
                isPlaying: true
            });

            const heartBtn = document.getElementById('playerHeartBtn');
            if (heartBtn) {
                heartBtn.classList.toggle('liked', likedTracks.has(track.id));
            }

            addToPreferences(track);

            showNotification(`Выбрано: ${track.title} - ${track.artist}`);
        }

        // Открытие альбома
        function openAlbum(album, source) {
            currentAlbum = album;

            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('settingsPage').style.display = 'none';
            document.getElementById('collectionPage').style.display = 'none';
            document.getElementById('soundSettingsPage').style.display = 'none';
            document.body.classList.add('settings-mode');

            const albumPage = document.getElementById('albumPage');
            albumPage.classList.add('active');
            albumPage.style.display = 'block';

            const header = document.getElementById('albumHeader');
            header.innerHTML = `
                <img src="${album.image}" class="album-cover-large" alt="${album.title}">
                <div class="album-info">
                    <div class="album-type">${album.type}</div>
                    <h1 class="album-name-large">${album.title}</h1>
                    <div class="album-artist-large">${album.artist}</div>
                    <div class="album-meta-large">
                        <span>${album.year}</span>
                        <span>•</span>
                        <span>${album.tracks} треков</span>
                        <span>•</span>
                        <span>${album.duration}</span>
                    </div>
                    <div class="album-actions">
                        <button class="play-album-btn" onclick="playAlbum()">
                            ▶ Слушать
                        </button>
                    </div>
                </div>
            `;

            const tracksList = document.getElementById('tracksList');
            tracksList.innerHTML = '';

            const tracks = album.tracksList && album.tracksList.length > 0 
                ? album.tracksList 
                : generateTracks(album.tracks, album.artist, album.title);

            tracks.forEach((track, index) => {
                const trackItem = document.createElement('div');
                trackItem.className = 'track-item-album';
                trackItem.onclick = () => playTrackFromAlbum(track);

                trackItem.innerHTML = `
                    <div class="track-number-album">${index + 1}</div>
                    <img src="${track.image || album.image}" class="track-image-album" alt="${track.title}">
                    <div class="track-info-album">
                        <div class="track-title-album">${track.title}</div>
                        <div class="track-artist-album">${track.artist}</div>
                    </div>
                    <div class="track-duration-album">${track.duration}</div>
                `;

                tracksList.appendChild(trackItem);
            });
        }

        // Генерация треков для альбома
        function generateTracks(count, artist, albumTitle) {
            const tracks = [];
            const trackTitles = [
                'Интро', 'Рассвет', 'День', 'Закат', 'Ночь',
                'Город', 'Дорога', 'Мечты', 'Реальность', 'Воспоминания'
            ];

            for (let i = 0; i < count; i++) {
                const title = trackTitles[i] || `Трек ${i + 1}`;
                const duration = `${Math.floor(Math.random() * 3) + 2}:${Math.floor(Math.random() * 60).toString().padStart(2, '0')}`;

                tracks.push({ 
                    id: `gen-${i}-${Date.now()}`,
                    title, 
                    artist,
                    album: albumTitle,
                    duration,
                    image: testImages[i % testImages.length]
                });
            }

            return tracks;
        }

        // Воспроизведение альбома
        function playAlbum() {
            if (!currentAlbum) return;

            const tracksList = document.getElementById('tracksList');
            const firstTrackItem = tracksList.querySelector('.track-item-album');

            if (firstTrackItem) {
                const trackIndex = parseInt(firstTrackItem.querySelector('.track-number-album').textContent) - 1;
                const tracks = currentAlbum.tracksList && currentAlbum.tracksList.length > 0 
                    ? currentAlbum.tracksList 
                    : generateTracks(currentAlbum.tracks, currentAlbum.artist, currentAlbum.title);

                if (tracks[trackIndex]) {
                    playTrackFromAlbum(tracks[trackIndex]);
                }
            }

            showNotification(`Воспроизведение: ${currentAlbum.title}`);
        }

        // Воспроизведение трека из альбома
        function playTrackFromAlbum(track) {
            currentTrack = track;

            updatePlayer({
                title: track.title,
                artist: track.artist,
                album: track.album || currentAlbum.title,
                image: track.image || currentAlbum.image,
                isPlaying: true
            });

            const heartBtn = document.getElementById('playerHeartBtn');
            if (heartBtn) {
                heartBtn.classList.toggle('liked', likedTracks.has(track.id));
            }

            addToPreferences(track);

            showNotification(`Воспроизведение: ${track.title} - ${track.artist}`);
        }

        // Воспроизведение трека из коллекции
        function playTrackFromCollection(track) {
            currentTrack = track;

            updatePlayer({
                title: track.title,
                artist: track.artist,
                album: track.album,
                image: track.image,
                isPlaying: true
            });

            const heartBtn = document.getElementById('playerHeartBtn');
            if (heartBtn) {
                heartBtn.classList.toggle('liked', likedTracks.has(track.id));
            }

            showNotification(`Воспроизведение: ${track.title} - ${track.artist}`);
        }

        // Смена языка
        function changeLanguage(langCode) {
            currentLanguage = langCode;
            loadLanguages();

            showNotification(`Язык изменен на: ${languages.find(l => l.code === langCode).name}`);
        }

        // Подписка на план
        function subscribeToPlan(planId, price) {
            const plans = [
                { id: 'yearly', period: 'ГОД' },
                { id: 'half-year', period: 'ПОЛГОДА' },
                { id: 'monthly', period: 'МЕСЯЦ' }
            ];

            const plan = plans.find(p => p.id === planId);
            if (plan) {
                const periodText = plan.period;
                showNotification(`Вы выбрали подписку: ${periodText} за ${price} TON`);
            }
        }

        // Применение промокода
        function applyPromocode() {
            const promocodeInput = document.getElementById('promocodeInput');
            const promocode = promocodeInput.value.trim();

            if (!promocode) {
                showNotification('Введите промокод');
                return;
            }

            if (promocode.toUpperCase() === 'MYRHYTHM2024' || promocode.toUpperCase() === 'TEST') {
                showNotification('Промокод успешно применен! Скидка 10% активирована.');
                promocodeInput.value = '';
            } else {
                showNotification('Недействительный промокод');
            }
        }

        // Техподдержка
        function contactSupport(type) {
            if (type === 'chat') {
                showNotification('Открывается онлайн-чат с поддержкой...');
            } else if (type === 'email') {
                showNotification('Открывается почтовый клиент...');
            }
        }

        function openFAQ() {
            showNotification('Открывается раздел FAQ...');
        }

        // Добавление в предпочтения
        function addToPreferences(track) {
            if (!userPreferences.some(pref => pref.id === track.id)) {
                userPreferences.push({
                    id: track.id,
                    title: track.title,
                    artist: track.artist,
                    genre: track.genre,
                    mood: track.mood,
                    timestamp: new Date().getTime()
                });

                if (userPreferences.length > 10) {
                    userPreferences.shift();
                }
            }
        }

        // Открытие страницы настроек звука
        function openSoundSettings() {
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('settingsPage').style.display = 'none';
            document.getElementById('collectionPage').style.display = 'none';
            document.getElementById('albumPage').style.display = 'none';
            document.body.classList.add('settings-mode');

            const soundSettingsPage = document.getElementById('soundSettingsPage');
            soundSettingsPage.classList.add('active');
            soundSettingsPage.style.display = 'block';
        }

        // Воспроизведение звука
        function playSound() {
            soundConfigured = true;
            const randomTrack = forYouTracks[Math.floor(Math.random() * forYouTracks.length)];
            openTrack(randomTrack, 'for-you');

            showNotification('Запущена "Моя волна" - персонализированная подборка на основе ваших предпочтений');
        }

        // Назад к основному контенту
        function goBack() {
            if (document.getElementById('soundSettingsPage').style.display === 'block') {
                document.getElementById('soundSettingsPage').style.display = 'none';
                document.getElementById('mainPage').style.display = 'block';
                document.body.classList.remove('settings-mode');
            } else if (document.getElementById('albumPage').style.display === 'block') {
                document.getElementById('albumPage').style.display = 'none';
                document.getElementById('mainPage').style.display = 'block';
                document.body.classList.remove('settings-mode');
                currentAlbum = null;
            } else {
                switchPage('music');
            }
        }

        // Обновление плеера
        function updatePlayer(trackData) {
            const playerTitle = document.querySelector('.player-title');
            const playerArtist = document.querySelector('.player-artist');
            const playerCover = document.querySelector('.player-cover');
            const playBtn = document.getElementById('playerPlayBtn');
            const heartBtn = document.getElementById('playerHeartBtn');

            if (playerTitle) playerTitle.textContent = trackData.title;
            if (playerArtist) playerArtist.textContent = `${trackData.artist} • ${trackData.album}`;

            if (playerCover && trackData.image) {
                playerCover.style.backgroundImage = `url('${trackData.image}')`;
                playerCover.style.backgroundSize = 'cover';
            }

            if (trackData.isPlaying && playBtn) {
                playBtn.classList.add('playing');
                isPlaying = true;
            } else if (playBtn) {
                playBtn.classList.remove('playing');
                isPlaying = false;
            }

            if (heartBtn && currentTrack) {
                heartBtn.classList.toggle('liked', likedTracks.has(currentTrack.id));
            }
        }

        // Настройка обработчиков событий
        function setupEventListeners() {
            const playBtn = document.getElementById('playerPlayBtn');
            if (playBtn) {
                playBtn.addEventListener('click', function() {
                    isPlaying = !isPlaying;
                    this.classList.toggle('playing');

                    if (currentTrack) {
                        if (isPlaying) {
                            showNotification(`Воспроизведение: ${currentTrack.title}`);
                        } else {
                            showNotification('Воспроизведение остановлено');
                        }
                    } else {
                        if (isPlaying) {
                            showNotification('Воспроизведение начато');
                        } else {
                            showNotification('Воспроизведение остановлено');
                        }
                    }
                });
            }

            const heartBtn = document.getElementById('playerHeartBtn');
            if (heartBtn) {
                heartBtn.addEventListener('click', function() {
                    if (!currentTrack) return;

                    if (likedTracks.has(currentTrack.id)) {
                        likedTracks.delete(currentTrack.id);
                        this.classList.remove('liked');
                        showNotification(`Трек "${currentTrack.title}" удален из коллекции`);
                    } else {
                        likedTracks.add(currentTrack.id);
                        this.classList.add('liked');
                        showNotification(`Трек "${currentTrack.title}" добавлен в коллекцию`);
                    }

                    if (currentPage === 'collection') {
                        updateCollectionPage();
                    }
                });
            }

            const promocodeInput = document.getElementById('promocodeInput');
            if (promocodeInput) {
                promocodeInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        applyPromocode();
                    }
                });
            }
        }

        // Вспомогательные функции
        function openCategory(categoryId) {
            console.log('Открыта категория:', categoryId);
        }

        function showUserMenu() {
            console.log('Открыто меню пользователя');
            alert('Меню пользователя: Профиль, Настройки, Выйти');
        }

        function showNotification(message) {
            const oldNotification = document.querySelector('.notification');
            if (oldNotification) {
                oldNotification.remove();
            }

            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 3000);
        }
    </script>
</body>
</html>
